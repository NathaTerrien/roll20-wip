<!-- === SCRIPT === -->
<script type="text/worker">
/* ---- mordiou ---------------------- */
    var mordiou = mordiou || (function(){
        'use strict';
        var version = '1.0',
        calcJet = function (pVal) {
            var nb = parseInt(pVal) || 0;
            var fortune = 0;
            var basejet = '({floor(1d6/2)-1,0d0}kh1)';
            var jet = '0d0';
            if (nb > 0) {
                var i = 1;
                jet = basejet;
                for (i = 1; i < nb; i++) {
                    jet = jet + " + " + basejet;
                }
            }
            return jet;
        };
        return {
            calcJet: calcJet
        };
    }());
/* ---- FIN mordiou ---------------------- */
    on("change:fortune", function(){
        getAttrs(["fortune"], function(values) {
            var nb = parseInt(values.fortune) || 0;
            var jet = mordiou.calcJet(nb);
            setAttrs({
                fortune_jet: jet
            });
        });
    });
    on("change:attention", function(){
        getAttrs(["attention"], function(values) {
            var nb = parseInt(values.attention) || 0;
            var jet = mordiou.calcJet(nb);
            setAttrs({
                attention_jet: jet
            });
        });
    });
</script>
<!-- === caracs cachées === -->
<input type="hidden" name="attr_plus2d" value="+ ({floor(1d6/2)-1,0d0}kh1) + ({floor(1d6/2)-1,0d0}kh1)" />
<input type="hidden" name="attr_moins2d" value="- ({floor(1d6/2)-1,0d0}kh1) - ({floor(1d6/2)-1,0d0}kh1)" />
<input type="hidden" name="attr_fortune_jet" value="({floor(1d6/2)-1,0d0}kh1) + ({floor(1d6/2)-1,0d0}kh1) + ({floor(1d6/2)-1,0d0}kh1)" />
<input type="hidden" name="attr_attention_jet" value="0d0" />

<!-- === SHEET === -->
<div class="bgmain">
    <div class="abs" style="left: 540px;top:16px;">
        <input type="text" name="attr_character_name" class="inptxt1" style="width: 300px;" placeholder="Nom du personnage" />
    </div> <!-- NOM -->
    <div class="abs" style="left: 490px;top: 175px;">
        <textarea name="attr_description" style="width: 684px;height: 105px;" placeholder="Description"></textarea>
    </div> <!-- DESCRIPTION -->
    <!-- ASPECTS -->
    <div class="abs" style="left: 490px;top:52px;">
        <input type="text" name="attr_aspect1" class="aspect" placeholder="1er Aspect" />
    </div>
    <div class="abs" style="left: 490px;top:79px;">
        <input type="text" name="attr_aspect2" class="aspect" placeholder="2nd Aspect" />
    </div>
    <div class="abs" style="left: 490px;top:108px;">
        <input type="text" name="attr_aspect3" class="aspect" placeholder="3ième Aspect" />
    </div>
    <div class="abs" style="left: 490px;top:136px;">
        <input type="text" name="attr_aspect4" class="aspect" placeholder="4ième Aspect" />
    </div>
    <!-- FIN ASPECTS -->
    <!-- Aspect de conflits -->
    <div class="abs" style="left: 1020px;top:52px;">
        <input type="text" name="attr_conflit1" style="width: 135px;" placeholder="Aspect de conflit 1" />
    </div>
    <div class="abs" style="left: 1157px;top:60px;">
        <input type="checkbox" name="attr_conflituse1" value="1" class="smallchk" title="Aspect de conflit 1 utilisé" /><span>&#9884;</span>
    </div>
    <div class="abs" style="left: 1020px;top:80px;">
        <input type="text" name="attr_conflit2" style="width: 135px;" placeholder="Aspect de conflit 2" />
    </div>
    <div class="abs" style="left: 1157px;top:90px;">
        <input type="checkbox" name="attr_conflituse2" value="1" class="smallchk" title="Aspect de conflit 2 utilisé" /><span>&#9884;</span>
    </div>
    <div class="abs" style="left: 1020px;top:109px;">
        <input type="text" name="attr_conflit3" style="width: 135px;" placeholder="Aspect de conflit 3" />
    </div>
    <div class="abs" style="left: 1157px;top:117px;">
        <input type="checkbox" name="attr_conflituse3" value="1" class="smallchk" title="Aspect de conflit 3 utilisé" /><span>&#9884;</span>
    </div>
    <div class="abs" style="left: 1020px;top:137px;">
        <input type="text" name="attr_conflit4" style="width: 135px;" placeholder="Aspect de conflit 4" />
    </div>
    <div class="abs" style="left: 1157px;top:146px;">
        <input type="checkbox" name="attr_conflituse4" value="1" class="smallchk" title="Aspect de conflit 4 utilisé" /><span>&#9884;</span>
    </div>
    <!-- FIN Aspect de conflits -->
    <!-- Fortune -->
    <div class="abs" style="left: 155px;top:135px;text-align: center;">
        <input type="number" name="attr_fortune" value="3" class="numbig1" title="Points de Fortune courants" />
        /
        <input type="number" name="attr_fortune_max" value="3" class="numbig1" title="Points de Fortune maximums" />
    </div>
    <!-- FIN Fortune -->
    <!-- EFFORT -->
    <div class="abs" style="left: 363px;top:311px;width:350px;text-align: left;white-space: nowrap;">
        <input type="radio" name="attr_effort" value="0" class="bigchk" checked title="Remettre les Efforts à zéro" /><span></span>
        <input type="radio" name="attr_effort" value="1" class="bigchk" style="margin-left: 1px;" title="1er Effort" /><span>&#9884;</span>
        <input type="radio" name="attr_effort" value="2" style="margin-left: 10px;" class="bigchk" title="2nd Effort" /><span>&#9884;</span>
        <input type="radio" name="attr_effort" value="3" style="margin-left: 9px;" class="bigchk" title="3ième Effort" /><span>&#9884;</span>
        <input type="radio" name="attr_effort" value="4" style="margin-left: 10px;" class="bigchk" title="4ième Effort" /><span>&#9884;</span>
        <input type="radio" name="attr_effort" value="5" style="margin-left: 9px;" class="bigchk" title="5ième Effort" /><span>&#9884;</span>
    </div>
    <!-- FIN EFFORT -->
    <!-- AIDE Dés -->
    <div class="abs" style="left: 1000px;top: 305px;">
        <table>
            <tr>
                <td>D6</td>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                <td>5</td>
                <td>6</td>
            </tr>
            <tr>
                <td>Qualités</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>1</td>
                <td>1</td>
                <td>2</td>
            </tr>
        </table>
    </div>
    <!-- FIN AIDE Dés -->
    <!-- ATTENTION -->
    <div class="abs" style="left: 90px;top:428px;">
        <input type="number" name="attr_attention" value="0" class="numbig1" />
    </div>
    <div class="abs" style="left: 58px;top:420px;">
        <button type="roll" class="sheet-butd6small block" name="JetAttention" title="Jet d'Attention" value="&{template:default} {{character=@{character_name}}} {{title=Attention}} {{subtitle=-}} {{qualites=[[@{attention_jet}[Attention] + @{fortune_jet}[Fortune]]]}}" ></button>
        <button type="roll" class="sheet-butd6smallgreen block" name="JetAttentionAspect" title="Jet d'Attention + 2D (Aspect applicable)" value="&{template:default} {{character=@{character_name}}} {{title=Attention}} {{subtitle=avec Aspect}} {{qualites=[[@{attention_jet}[Attention] + @{fortune_jet}[Fortune] @{plus2d}[Aspect]]]}}" ></button>
        <button type="roll" class="sheet-butd6smallred block" name="JetAttentionDef" title="Jet d'Attention - 2D (circonstances défavorables)" value="&{template:default} {{character=@{character_name}}} {{title=Attention}} {{subtitle=Circonstances défavorables}} {{qualites=[[@{attention_jet}[Attention] + @{fortune_jet}[Fortune] @{moins2d}[Circonstances]]]}}" ></button>
    </div>
    <!-- FIN ATTENTION -->
    <div class="abs" style="left: 266px;top:428px;">
        <input type="number" name="attr_eloquence" value="0" class="numbig1" />
    </div> <!-- ELOQUENCE -->
    <div class="abs" style="left: 442px;top:428px;">
        <input type="number" name="attr_erudition" value="0" class="numbig1" />
    </div> <!-- ERUDITION -->
    <div class="abs" style="left: 619px;top:428px;">
        <input type="number" name="attr_panache" value="0" class="numbig1" />
    </div> <!-- PANACHE -->
    <div class="abs" style="left: 796px;top:428px;">
        <input type="number" name="attr_resolution" value="0" class="numbig1" />
    </div> <!-- RESOLUTION -->
    <div class="abs" style="left: 973px;top:428px;">
        <input type="number" name="attr_ruse" value="0" class="numbig1" />
    </div> <!-- RUSE -->
    <div class="abs" style="left: 1149px;top:428px;">
        <input type="number" name="attr_vigueur" value="0" class="numbig1" />
    </div> <!-- VIGUEUR -->
</div>
