<div class="main">
    <div class="myrow"> <!-- top row -->
        <div class="col1third"> <!-- logo -->
            <img style="width: 270px;" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/logo.png" />
        </div>
        <div class="col2third" style="padding-top: 4px;"> <!-- identity -->
            <div class="myrow">
                <div class="identity">
                    <input type="text" name="attr_character_name" class="underlined" spellcheck="false" title="@{character_name}" />
                    <span data-i18n="character-name">character name</span>
                </div>
                <div class="identity">
                    <select class="alignment underlined" name="attr_alignment" title="@{alignment}">
                        <option value="lawful good" data-i18n="lawful-good">lawful good</option>
                        <option value="neutral good" data-i18n="neutral-good">neutral good</option>
                        <option value="chaotic good" data-i18n="chaotic-good">chaotic good</option>
                        <option value="lawful neutral" data-i18n="lawful-neutral">lawful neutral</option>
                        <option value="neutral" data-i18n="neutral" selected="selected">neutral</option>
                        <option value="chaotic neutral" data-i18n="chaotic-neutral">chaotic neutral</option>
                        <option value="lawful evil" data-i18n="lawful-evil">lawful evil</option>
                        <option value="neutral evil" data-i18n="neutral-evil">neutral evil</option>
                        <option value="chaotic evil" data-i18n="chaotic-evil">chaotic evil</option>
                    </select>
                    <span data-i18n="alignment">alignment</span>
                </div>
                <div class="identity">
                    <input type="text" name="attr_player" class="underlined" spellcheck="false" title="@{player}" />
                    <span data-i18n="player">player</span>
                </div>
            </div>
            <div class="myrow">
                <div class="identity">
                    <input type="text" name="attr_class" class="underlined" spellcheck="false" title="@{class}" />
                    <span data-i18n="class">Class</span>
                </div>
                <div class="identity">
                    <input type="number" name="attr_level" value="1" class="underlined" title="@{level}" />
                    <span data-i18n="level">Level</span>
                </div>
                <div class="identity">
                    <input type="text" name="attr_deity" class="underlined medium" spellcheck="false" title="@{deity}" />
                    <span data-i18n="deity">Deity</span>
                </div>
                <div class="identity">
                    <input type="text" name="attr_homeland" class="underlined medium" spellcheck="false" title="@{homeland}" />
                    <span data-i18n="homeland">Homeland</span>
                </div>
            </div>
            <div class="myrow">
                <div class="identity">
                    <input type="text" name="attr_race" class="underlined medium" spellcheck="false" title="@{race}" />
                    <span data-i18n="race">Race</span>
                </div>
                <div class="identity">
                    <select class="size underlined" name="attr_size" title="@{size}">
                        <option value="fine" data-i18n="fine">Fine</option>
                        <option value="diminutive" data-i18n="diminutive">Diminutive</option>
                        <option value="tiny" data-i18n="tiny">Tiny</option>
                        <option value="small" data-i18n="small">Small</option>
                        <option value="medium" data-i18n="medium" selected="selected">Medium</option>
                        <option value="large" data-i18n="large">Large</option>
                        <option value="huge" data-i18n="huge">Huge</option>
                        <option value="gargantuan" data-i18n="gargantuan">Gargantuan</option>
                        <option value="colossal" data-i18n="colossal">Colossal</option>
                    </select>
                    <span data-i18n="size">Size</span>
                </div>
                <div class="identity">
                    <input type="text" name="attr_gender" class="underlined small" spellcheck="false" title="@{gender}" />
                    <span data-i18n="gender">Gender</span>
                </div>
                <div class="identity">
                    <input type="text" name="attr_age" class="underlined small" spellcheck="false" title="@{age}" />
                    <span data-i18n="age">Age</span>
                </div>
                <div class="identity">
                    <input type="text" name="attr_height" class="underlined small" spellcheck="false" title="@{height}" />
                    <span data-i18n="height-char">Height</span>
                </div>
                <div class="identity">
                    <input type="text" name="attr_weight" class="underlined small" spellcheck="false" title="@{weight}" />
                    <span data-i18n="weight-char">Weight</span>
                </div>
                <div class="identity">
                    <input type="text" name="attr_hair" class="underlined small" spellcheck="false" title="@{hair}" />
                    <span data-i18n="hair">Hair</span>
                </div>
                <div class="identity">
                    <input type="text" name="attr_eyes" class="underlined small" spellcheck="false" title="@{eyes}" />
                    <span data-i18n="eyes">Eyes</span>
                </div>
            </div>
        </div> <!-- END identity -->
    </div> <!-- END top row -->
    <!-- PSEUDO TABS -->
    <input type="radio" name="attr_tabcurrent" class="tabmain" value="tabmain" checked /><span data-i18n="tab-main">Main</span>
    <input type="radio" name="attr_tabcurrent" class="tabadd" value="tabadd" /><span data-i18n="tab-additional">Additional</span>
    <input type="radio" name="attr_tabcurrent" class="tabspell" value="tabspell" /><span data-i18n="tab-spells">Spells</span>
    <input type="radio" name="attr_tabcurrent" class="tabconf" value="tabconf" /><span data-i18n="tab-configuration">Configuration</span>
    <div class="tabmain"> <!-- TAB MAIN -->
        <div class="colhalf"> <!-- tab1 col1 -->
            <div class="abilities"> <!-- abilities -->
                <div class="labline">
                    <span class="lab" data-i18n="ability-name" data-i18n-title="ability-name" title="Ability Name">Ability Name</span>
                    <span class="lab" data-i18n="score" data-i18n-title="ability-score" title="Score">Score</span>
                    <span class="lab" data-i18n="modifier" data-i18n-title="ability-modifier" title="Modifier">Modifier</span>
                    <span class="lab" data-i18n="temp" data-i18n-title="temp-adjustment" title="Temp Adjustment">Temp</span>
                </div>
                <div class="ability"> <!-- strength -->
                    <input class="options-flag" name="attr_options-flag-str" type="checkbox" data-i18n-title="show-hide-notes" title="Show/hide notes"><span>i</span>
                    <div class="myrow">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="StrRoll" data-i18n-title="strength-roll" title="Strength roll" value="@{whispertype} &{template:default} {{name=^{strength}}} {{type=ability}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20+@{strength_mod}[MOD]+@{rollmod_ability}[BONUS]]]}} {{shownotes=@{rollnotes_ability}}} {{notes=@{strength_notes}}}"><span data-i18n="str">str</span></button>
                                <span class="sml" data-i18n="strength" data-i18n-title="strength" title="Strength">Strength</span>
                            </div>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_strength_base" value="10" class="baseattr" title="@{strength}" />
                            <input type="hidden" name="attr_strength" value="10" />
                            <input type="hidden" name="attr_strength_flag" value="0" class="attr-flag" />
                            <span name="attr_strength" class="pseudoattr finalattr"></span>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_strength_mod" class="pseudoattr" title="@{strength_mod}"></span>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_strength_bonus" class="boxed" value="0" title="@{strength_bonus}" />
                        </div>
                    </div>
                    <div class="options">
                        <div class="autoex">
                            <span name="attr_strength_notes"></span>
                            <textarea name="attr_strength_notes" spellcheck="false" data-i18n-placeholder="notes-ability-placeholder" placeholder="Notes: +2 racial, +1 magic item..."></textarea>
                        </div>
                    </div>
                </div> <!-- END strength -->
                <div class="ability"> <!-- dexterity -->
                    <input class="options-flag" name="attr_options-flag-dex" type="checkbox" data-i18n-title="show-hide-notes" title="Show/hide notes"><span>i</span>
                    <div class="myrow">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="DexRoll" data-i18n-title="dexterity-roll" title="Dexterity roll" value="@{whispertype} &{template:default} {{name=^{dexterity}}} {{type=ability}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20+@{dexterity_mod}[MOD]+@{rollmod_ability}[BONUS]]]}} {{shownotes=@{rollnotes_ability}}} {{notes=@{dexterity_notes}}}"><span data-i18n="dex">dex</span></button>
                                <span class="sml" data-i18n="dexterity" data-i18n-title="dexterity" title="Dexterity">Dexterity</span>
                            </div>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_dexterity_base" value="10" class="baseattr" title="@{dexterity}" />
                            <input type="hidden" name="attr_dexterity" value="10" />
                            <input type="hidden" name="attr_dexterity_flag" value="0" class="attr-flag" />
                            <span name="attr_dexterity" class="pseudoattr finalattr"></span>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_dexterity_mod" class="pseudoattr" title="@{dexterity_mod}"></span>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_dexterity_bonus" class="boxed" value="0" title="@{dexterity_bonus}" />
                        </div>
                    </div>
                    <div class="options">
                        <div class="autoex">
                            <span name="attr_dexterity_notes"></span>
                            <textarea name="attr_dexterity_notes" spellcheck="false" data-i18n-placeholder="notes-ability-placeholder" placeholder="Notes: +2 racial, +1 magic item..."></textarea>
                        </div>
                    </div>
                </div> <!-- END dexterity -->
                <div class="ability"> <!-- constitution -->
                    <input class="options-flag" name="attr_options-flag-con" type="checkbox" data-i18n-title="show-hide-notes" title="Show/hide notes"><span>i</span>
                    <div class="myrow">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="ConRoll" data-i18n-title="constitution-roll" title="Constitution roll" value="@{whispertype} &{template:default} {{name=^{constitution}}} {{type=ability}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20+@{constitution_mod}[MOD]+@{rollmod_ability}[BONUS]]]}} {{shownotes=@{rollnotes_ability}}} {{notes=@{constitution_notes}}}"><span data-i18n="con">con</span></button>
                                <span class="sml" data-i18n="constitution" data-i18n-title="constitution" title="Constitution">Constitution</span>
                            </div>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_constitution_base" value="10" class="baseattr" title="@{constitution}" />
                            <input type="hidden" name="attr_constitution" value="10" />
                            <input type="hidden" name="attr_constitution_flag" value="0" class="attr-flag" />
                            <span name="attr_constitution" class="pseudoattr finalattr"></span>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_constitution_mod" class="pseudoattr" title="@{constitution_mod}"></span>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_constitution_bonus" class="boxed" value="0" title="@{constitution_bonus}" />
                        </div>
                    </div>
                    <div class="options">
                        <div class="autoex">
                            <span name="attr_constitution_notes"></span>
                            <textarea name="attr_constitution_notes" spellcheck="false" data-i18n-placeholder="notes-ability-placeholder" placeholder="Notes: +2 racial, +1 magic item..."></textarea>
                        </div>
                    </div>
                </div> <!-- END constitution -->
                <div class="ability"> <!-- intelligence -->
                    <input class="options-flag" name="attr_options-flag-int" type="checkbox" data-i18n-title="show-hide-notes" title="Show/hide notes"><span>i</span>
                    <div class="myrow">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="IntRoll" data-i18n-title="intelligence-roll" title="Intelligence roll" value="@{whispertype} &{template:default} {{name=^{intelligence}}} {{type=ability}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20+@{intelligence_mod}[MOD]+@{rollmod_ability}[BONUS]]]}} {{shownotes=@{rollnotes_ability}}} {{notes=@{intelligence_notes}}}"><span data-i18n="int">int</span></button>
                                <span class="sml" data-i18n="intelligence" data-i18n-title="intelligence" title="Intelligence">Intelligence</span>
                            </div>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_intelligence_base" value="10" class="baseattr" title="@{intelligence}" />
                            <input type="hidden" name="attr_intelligence" value="10" />
                            <input type="hidden" name="attr_intelligence_flag" value="0" class="attr-flag" />
                            <span name="attr_intelligence" class="pseudoattr finalattr"></span>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_intelligence_mod" class="pseudoattr" title="@{intelligence_mod}"></span>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_intelligence_bonus" class="boxed" value="0" title="@{intelligence_bonus}" />
                        </div>
                    </div>
                    <div class="options">
                        <div class="autoex">
                            <span name="attr_intelligence_notes"></span>
                            <textarea name="attr_intelligence_notes" spellcheck="false" data-i18n-placeholder="notes-ability-placeholder" placeholder="Notes: +2 racial, +1 magic item..."></textarea>
                        </div>
                    </div>
                </div> <!-- END intelligence -->
                <div class="ability"> <!-- wisdom -->
                    <input class="options-flag" name="attr_options-flag-wis" type="checkbox" data-i18n-title="show-hide-notes" title="Show/hide notes"><span>i</span>
                    <div class="myrow">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="WisRoll" data-i18n-title="wisdom-roll" title="Wisdom roll" value="@{whispertype} &{template:default} {{name=^{wisdom}}} {{type=ability}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20+@{wisdom_mod}[MOD]+@{rollmod_ability}[BONUS]]]}} {{shownotes=@{rollnotes_ability}}} {{notes=@{wisdom_notes}}}"><span data-i18n="wis">wis</span></button>
                                <span class="sml" data-i18n="wisdom" data-i18n-title="wisdom" title="Wisdom">Wisdom</span>
                            </div>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_wisdom_base" value="10" class="baseattr" title="@{wisdom}" />
                            <input type="hidden" name="attr_wisdom" value="10" />
                            <input type="hidden" name="attr_wisdom_flag" value="0" class="attr-flag" />
                            <span name="attr_wisdom" class="pseudoattr finalattr"></span>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_wisdom_mod" class="pseudoattr" title="@{wisdom_mod}"></span>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_wisdom_bonus" class="boxed" value="0" title="@{wisdom_bonus}" />
                        </div>
                    </div>
                    <div class="options">
                        <div class="autoex">
                            <span name="attr_wisdom_notes"></span>
                            <textarea name="attr_wisdom_notes" spellcheck="false" data-i18n-placeholder="notes-ability-placeholder" placeholder="Notes: +2 racial, +1 magic item..."></textarea>
                        </div>
                    </div>
                </div> <!-- END wisdom -->
                <div class="ability"> <!-- charisma -->
                    <input class="options-flag" name="attr_options-flag-cha" type="checkbox" data-i18n-title="show-hide-notes" title="Show/hide notes"><span>i</span>
                    <div class="myrow">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="ChaRoll" data-i18n-title="charisma-roll" title="Charisma roll" value="@{whispertype} &{template:default} {{name=^{charisma}}} {{type=ability}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20+@{charisma_mod}[MOD]+@{rollmod_ability}[BONUS]]]}} {{shownotes=@{rollnotes_ability}}} {{notes=@{charisma_notes}}}"><span data-i18n="cha">cha</span></button>
                                <span class="sml" data-i18n="charisma" data-i18n-title="charisma" title="Charisma">Charisma</span>
                            </div>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_charisma_base" value="10" class="baseattr" title="@{charisma}" />
                            <input type="hidden" name="attr_charisma" value="10" />
                            <input type="hidden" name="attr_charisma_flag" value="0" class="attr-flag" />
                            <span name="attr_charisma" class="pseudoattr finalattr"></span>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_charisma_mod" class="pseudoattr" title="@{charisma_mod}"></span>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_charisma_bonus" class="boxed" value="0" title="@{charisma_bonus}" />
                        </div>
                    </div>
                    <div class="options">
                        <div class="autoex">
                            <span name="attr_charisma_notes"></span>
                            <textarea name="attr_charisma_notes" spellcheck="false" data-i18n-placeholder="notes-ability-placeholder" placeholder="Notes: +2 racial, +1 magic item..."></textarea>
                        </div>
                    </div>
                </div> <!-- END charisma -->
            </div>  <!-- END abilities -->
            <div class="subcol hpinit">
                <div class="hpvalues"> <!-- HP -->
                    <div class="myrow labline">
                        <span class="lab">&nbsp;</span>
                        <span class="lab" data-i18n="curr" data-i18n-title="current" title="Current">curr</span>
                        <span class="lab" data-i18n="max" data-i18n-title="maximum" title="Maximum">max</span>
                    </div>
                    <div class="myrow">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="HdRoll" data-i18n-title="hit-die-roll" title="Hit Die roll" value="@{whispertype} &{template:default} {{name=^{hit-die}}} {{type=hp}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d@{hitdietype}+@{constitution_mod}[MOD]]]}}"><span data-i18n="hp-u">HP</span></button>
                                <span class="sml" data-i18n="hit-points" data-i18n-title="hit-points" title="Hit Points">Hit Points</span>
                            </div>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_hp" class="boxed" value="0" title="@{hp}" />
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_hp_max" class="boxed" value="0" title="@{hp_max}" />
                        </div>
                    </div>
                    <div class="myrow labline top">
                        <span class="lab">&nbsp;</span>
                        <span class="lab" data-i18n="nonlethal" data-i18n-title="nonlethal-damage" title="Nonlethal Damage">nonlethal</span>
                        <span class="lab" data-i18n="dr-u" data-i18n-title="damage-reduction" title="Damage Reduction">DR</span>
                    </div>
                    <div class="myrow">
                        <span class="lab">&nbsp;</span>
                        <div class="boxed">
                            <input type="number" name="attr_nonlethaldmg" class="boxed" value="0" title="@{nonlethaldmg}" />
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_dr" class="boxed" value="0" title="@{dr}" />
                        </div>
                    </div>
                </div> <!-- END HP -->
                <div class="spacer"></div>
                <div class="initiative"> <!-- INITIATIVE -->
                    <input class="options-flag" name="attr_options-flag-initiative" type="checkbox" data-i18n-title="show-hide-options" title="Show/hide options"><span>y</span>
                    <div class="myrow">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="InitRoll" data-i18n-title="initiative-roll" title="Initiative roll" value="@{whispertype} &{template:default} {{name=^{initiative}}} {{type=initiative}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20+@{initiative_mod}[MOD]+@{rollmod_initiative}[BONUS] &{tracker}]]}} {{shownotes=@{rollnotes_initiative}}} {{notes=@{initiative_notes}}}"><span data-i18n="init">Init</span></button>
                                <span class="sml" data-i18n="initiative" data-i18n-title="initiative" title="Initiative">Initiative</span>
                            </div>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_initiative_mod" class="pseudoattr" title="@{initiative_mod}"></span>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_initiative_bonus" class="boxed" value="0" title="@{initiative_bonus}" />
                        </div>
                    </div>
                    <div class="myrow labline bottom">
                        <span class="lab" style="margin-left: 73px;" data-i18n="total" data-i18n-title="total" title="Total">Total</span>
                        <span class="lab" data-i18n="temp" data-i18n-title="temp-adjustment" title="Temp Adjustment">Temp</span>
                    </div>
                    <div class="options">
                        <div class="myrow">
                            <span class="spacer">=</span>
                            <div class="boxed greybg">
                                <span name="attr_dexterity_mod" class="pseudoattr" title="@{dexterity_mod}"></span>
                            </div>
                            <span class="spacer">+</span>
                            <div class="boxed">
                                <input type="number" name="attr_initiative_misc" class="boxed" value="0" title="@{initiative_misc}" />
                            </div>
                        </div>
                        <div class="myrow labline bottom">
                            <span class="spacer"></span>
                            <span class="lab" data-i18n="dex" data-i18n-title="dexterity-modifier" title="Dexterity Modifier">dex</span>
                            <span class="spacer"></span>
                            <span class="lab" data-i18n="misc" data-i18n-title="misc-modifier" title="Misc Modifier">Misc</span>
                        </div>
                        <div class="autoex">
                            <span name="attr_initiative_notes"></span>
                            <textarea name="attr_initiative_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes" title="@{initiative_notes}"></textarea>
                        </div>
                    </div>
                </div><!-- END initiative -->
            </div>
            <div class="spacer"></div>
            <div class="acvalues">
                <input class="options-flag" name="attr_options-flag-ac" type="checkbox" data-i18n-title="show-hide-options" title="Show/hide options"><span>y</span>
                <div class="myrow"> <!-- AC -->
                    <div class="blacklabel ac">
                        <div class="blackbgrd">
                            <span class="big only" data-i18n="ac-u" data-i18n-title="armor-class" title="Armor Class">AC</span>
                        </div>
                    </div>
                    <div class="boxed greybg">
                        <span name="attr_ac" class="pseudoattr" title="@{ac}"></span>
                    </div>
                    <div class="boxed">
                        <input type="number" name="attr_ac_bonus" class="boxed" value="0" title="@{ac_bonus}" />
                    </div>
                    <div class="blacklabel touch">
                        <div class="blackbgrd">
                            <span class="big" data-i18n="touch">Touch</span>
                            <span class="sml" data-i18n="armor-class" data-i18n-title="armor-class" title="Armor Class">Armor Class</span>
                        </div>
                    </div>
                    <div class="boxed greybg">
                        <span name="attr_ac_touch" class="pseudoattr" title="@{ac_touch}"></span>
                    </div>
                    <div class="blacklabel flatfooted">
                        <div class="blackbgrd">
                            <span class="big" data-i18n="flat-footed">Flat-footed</span>
                            <span class="sml" data-i18n="armor-class" data-i18n-title="armor-class" title="Armor Class">Armor Class</span>
                        </div>
                    </div>
                    <div class="boxed greybg">
                        <span name="attr_ac_flatfooted" class="pseudoattr" title="@{ac_flatfooted}"></span>
                    </div>
                </div>
                <div class="myrow labline bottom">
                    <span class="lab" style="margin-left: 43px;" data-i18n="total" data-i18n-title="total" title="Total">Total</span>
                    <span class="lab" data-i18n="temp" data-i18n-title="temp-adjustment" title="Temp Adjustment">Temp</span>
                </div>
                <div class="options">
                    <div class="myrow">
                        <span class="spacer">=</span>
                        <span class="spacer">10</span>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_ac_armor" class="pseudoattr" title="@{ac_armor}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_ac_shield" class="pseudoattr" title="@{ac_shield}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_ac_ability_mod" class="pseudoattr" title="@{ac_ability_mod}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_ac_size" class="pseudoattr" title="@{ac_size}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed">
                            <input type="number" name="attr_ac_natural" class="boxed" value="0" title="@{ac_natural}" />
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed">
                            <input type="number" name="attr_ac_deflection" class="boxed" value="0" title="@{ac_deflection}" />
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed">
                            <input type="number" name="attr_ac_misc" class="boxed" value="0" title="@{ac_misc}" />
                        </div>
                    </div>
                    <div class="myrow labline bottom">
                        <span class="spacer"></span>
                        <span class="spacer"></span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="armor" data-i18n-title="armor-bonus" title="Armor Bonus">Armor</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="shield" data-i18n-title="shield-bonus" title="Shield Bonus">Shield</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="ability" data-i18n-title="ability-modifier" title="Ability Modifier">Ability</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="size" data-i18n-title="size-modifier" title="Size Modifier">Size</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="natural" data-i18n-title="natural-armor" title="Natural Armor">Natural</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="deflection" data-i18n-title="deflection-modifier" title="Deflection Modifier">Deflection</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="misc" data-i18n-title="misc-bonus" title="Misc Bonus">Misc</span>
                    </div>
                    <div class="autoex">
                        <span name="attr_ac_notes"></span>
                        <textarea name="attr_ac_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes" title="@{ac_notes}"></textarea>
                    </div>
                </div>
            </div>  <!-- END AC -->
            <div class="spacer"></div>
            <div class="saves"> <!-- SAVING THROWS -->
                <input class="options-flag fortitude" name="attr_options-flag-fortitude" type="checkbox" value="1" data-i18n-title="show-hide-options" title="Show/hide options"><span>y</span>
                <input class="options-flag reflex" name="attr_options-flag-reflex" type="checkbox" value="1" data-i18n-title="show-hide-options" title="Show/hide options"><span>y</span>
                <input class="options-flag will" name="attr_options-flag-will" type="checkbox" value="1" data-i18n-title="show-hide-options" title="Show/hide options"><span>y</span>
                <div class="myrow">
                    <div class="save fortitude">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="FortRoll" data-i18n-title="fortitude-roll" title="Fortitude roll" value="@{whispertype} &{template:default} {{name=^{fortitude}}} {{type=save}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20+@{fortitude}[MOD]+@{rollmod_ability}[BONUS]]]}} {{shownotes=@{rollnotes_save}}} {{notes=@{fortitude_notes}}}"><span data-i18n="fort-u">FORT</span></button>
                                <span class="sml" data-i18n="fortitude" data-i18n-title="fortitude" title="Fortitude">Fortitude</span>
                            </div>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_fortitude" class="pseudoattr" title="@{fortitude}"></span>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_fortitude_bonus" class="boxed" value="0" title="@{fortitude_bonus}" />
                        </div>
                    </div>
                    <div class="save reflex">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="RefRoll" data-i18n-title="reflex-roll" title="Reflex roll" value="@{whispertype} &{template:default} {{name=^{reflex}}} {{type=save}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20+@{reflex}[MOD]+@{rollmod_ability}[BONUS]]]}} {{shownotes=@{rollnotes_save}}} {{notes=@{reflex_notes}}}"><span data-i18n="ref-u">REF</span></button>
                                <span class="sml" data-i18n="reflex" data-i18n-title="reflex" title="Reflex">Reflex</span>
                            </div>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_reflex" class="pseudoattr" title="@{reflex}"></span>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_reflex_bonus" class="boxed" value="0" title="@{reflex_bonus}" />
                        </div>
                    </div>
                    <div class="save will">
                        <div class="blacklabel">
                            <div class="blackbgrd">
                                <button class="myrol big" type="roll" name="WillRoll" data-i18n-title="will-roll" title="Will roll" value="@{whispertype} &{template:default} {{name=^{will}}} {{type=save}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20+@{will}[MOD]+@{rollmod_ability}[BONUS]]]}} {{shownotes=@{rollnotes_save}}} {{notes=@{will_notes}}}"><span data-i18n="will-u">WILL</span></button>
                                <span class="sml" data-i18n="will" data-i18n-title="will" title="Will">Will</span>
                            </div>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_will" class="pseudoattr" title="@{will}"></span>
                        </div>
                        <div class="boxed">
                            <input type="number" name="attr_will_bonus" class="boxed" value="0" title="@{will_bonus}" />
                        </div>
                    </div>
                </div>
                <div class="myrow labline bottom">
                    <span class="lab" style="margin-left: 61px;" data-i18n="total" data-i18n-title="total" title="Total">Total</span>
                    <span class="lab" data-i18n="temp" data-i18n-title="temp-adjustment" title="Temp Adjustment">Temp</span>
                    <span class="lab" style="margin-left: 47px;" data-i18n="total" data-i18n-title="total" title="Total">Total</span>
                    <span class="lab" data-i18n="temp" data-i18n-title="temp-adjustment" title="Temp Adjustment">Temp</span>
                    <span class="lab" style="margin-left: 58px;" data-i18n="total" data-i18n-title="total" title="Total">Total</span>
                    <span class="lab" data-i18n="temp" data-i18n-title="temp-adjustment" title="Temp Adjustment">Temp</span>
                </div>
                <div class="options-fortitude">
                    <div class="myrow">
                        <span class="spacer" data-i18n="fort-u" data-i18n-title="fortitude" title="Fortitude">FORT</span>
                        <span class="spacer">=</span>
                        <div class="boxed greybg">
                            <span name="attr_fortitude_base" class="pseudoattr" title="@{fortitude_base}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_fortitude_ability_mod" class="pseudoattr" title="@{fortitude_ability_mod}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed">
                            <input type="number" name="attr_fortitude_misc" class="boxed" value="0" title="@{fortitude_misc}" />
                        </div>
                    </div>
                    <div class="myrow labline bottom">
                        <span class="spacer invisible" data-i18n="fort-u" data-i18n-title="fortitude" title="Fortitude">FORT</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="base" data-i18n-title="base-modifier" title="Base Modifier">Base</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="ability" data-i18n-title="ability-modifier" title="Ability Modifier">Ability</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="misc" data-i18n-title="misc-modifier" title="Misc Modifier">Misc</span>
                    </div>
                    <div class="autoex">
                        <span name="attr_fortitude_notes"></span>
                        <textarea name="attr_fortitude_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes" title="@{fortitude_notes}"></textarea>
                    </div>
                </div>
                <div class="options-reflex">
                    <div class="myrow center">
                        <span class="spacer" data-i18n="ref-u" data-i18n-title="reflex" title="Reflex">REF</span>
                        <span class="spacer">=</span>
                        <div class="boxed greybg">
                            <span name="attr_reflex_base" class="pseudoattr" title="@{reflex_base}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_reflex_ability_mod" class="pseudoattr" title="@{reflex_ability_mod}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed">
                            <input type="number" name="attr_reflex_misc" class="boxed" value="0" title="@{reflex_misc}" />
                        </div>
                    </div>
                    <div class="myrow center labline bottom">
                        <span class="spacer invisible" data-i18n="ref-u" data-i18n-title="reflex" title="Reflex">REF</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="base" data-i18n-title="base-modifier" title="Base Modifier">Base</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="ability" data-i18n-title="ability-modifier" title="Ability Modifier">Ability</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="misc" data-i18n-title="misc-modifier" title="Misc Modifier">Misc</span>
                    </div>
                    <div class="autoex">
                        <span name="attr_reflex_notes"></span>
                        <textarea name="attr_reflex_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes" title="@{reflex_notes}"></textarea>
                    </div>
                </div>
                <div class="options-will">
                    <div class="myrow right">
                        <span class="spacer" data-i18n="will-u" data-i18n-title="will" title="Will">WILL</span>
                        <span class="spacer">=</span>
                        <div class="boxed greybg">
                            <span name="attr_will_base" class="pseudoattr" title="@{will_base}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_will_ability_mod" class="pseudoattr" title="@{will_ability_mod}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed">
                            <input type="number" name="attr_will_misc" class="boxed" value="0" title="@{will_misc}" />
                        </div>
                    </div>
                    <div class="myrow right labline bottom">
                        <span class="spacer invisible" data-i18n="will-u" data-i18n-title="will" title="Will">WILL</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="base" data-i18n-title="base-modifier" title="Base Modifier">Base</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="ability" data-i18n-title="ability-modifier" title="Ability Modifier">Ability</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="misc" data-i18n-title="misc-modifier" title="Misc Modifier">Misc</span>
                    </div>
                    <div class="autoex">
                        <span name="attr_will_notes"></span>
                        <textarea name="attr_will_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes" title="@{will_notes}"></textarea>
                    </div>
                </div>
            </div> <!-- END SAVING THROWS -->
            <div class="spacer"></div>
            <div class="babs"> <!-- BABS -->
                <input class="options-flag bab" name="attr_options-flag-bab" type="checkbox" value="1" data-i18n-title="show-hide-options" title="Show/hide options"><span>i</span>
                <input class="options-flag cmb" name="attr_options-flag-cmb" type="checkbox" value="1" data-i18n-title="show-hide-options" title="Show/hide options"><span>y</span>
                <div class="myrow">
                    <div class="blacklabel bab">
                        <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                        <div class="blackbgrd">
                            <span class="big only" data-i18n="base-attack-bonus">Base Attack Bonus</span>
                        </div>
                    </div>
                    <div class="boxed">
                        <input type="number" name="attr_bab" class="boxed" value="0" title="@{bab}" />
                    </div>
                    <div class="blacklabel cmb">
                        <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                        <div class="blackbgrd">
                            <button class="myrol big only" type="roll" name="CmbRoll" value="@{whispertype} &{template:default} {{name=^{combat-maneuver}}} {{type=attack}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20cs20+@{cmb_mod}[MOD]+@{rollmod_attack}[BONUS]]]}} {{shownotes=@{rollnotes_attack}}} {{notes=@{cmb_notes}}}"><span data-i18n="cmb-u" data-i18n-title="combat-maneuver-bonus" title="Combat Maneuver Bonus">CMB</span></button>
                        </div>
                    </div>
                    <div class="boxed greybg">
                        <span name="attr_cmb_mod" class="pseudoattr" title="@{cmb_mod}"></span>
                    </div>
                    <div class="boxed">
                        <input type="number" name="attr_cmb_bonus" class="boxed" value="0" title="@{cmb_bonus}" />
                    </div>
                </div>
                <div class="myrow labline bottom">
                    <span class="lab" style="margin-left: 340px;" data-i18n="total" data-i18n-title="total" title="Total">Total</span>
                    <span class="lab" data-i18n="temp" data-i18n-title="temp-adjustment" title="Temp Adjustment">Temp</span>
                </div>
                <div class="options-bab">
                    <div class="autoex">
                        <span name="attr_bab_notes"></span>
                        <textarea name="attr_bab_notes" spellcheck="false" data-i18n-placeholder="bab-notes" placeholder="BAB Notes" title="@{bab_notes}"></textarea>
                    </div>
                </div>
                <div class="options-cmb">
                    <div class="myrow right">
                        <span class="spacer" data-i18n="cmb-u" data-i18n-bonus="combat-maneuver-bonus" title="Combat Maneuver Bonus">CMB</span>
                        <span class="spacer">=</span>
                        <div class="boxed greybg">
                            <span name="attr_bab" class="pseudoattr" title="@{bab}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_cmb_ability_mod" class="pseudoattr" title="@{cmb_ability_mod}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_cmb_size" class="pseudoattr" title="@{cmb_size}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed">
                            <input type="number" name="attr_cmb_misc" class="boxed" value="0" title="@{cmb_misc}" />
                        </div>
                    </div>
                    <div class="myrow right labline bottom">
                        <span class="spacer invisible" data-i18n="cmb-u" data-i18n-bonus="combat-maneuver-bonus" title="Combat Maneuver Bonus">CMB</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="bab-u" data-i18n-title="base-attack-bonus" title="Base Attack Bonus">BAB</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="ability" data-i18n-title="ability-modifier" title="Ability Modifier">Ability</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="size" data-i18n-title="size-modifier" title="Size Modifier">Size</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="misc" data-i18n-title="misc-modifier" title="Misc Modifier">Misc</span>
                    </div>
                    <div class="autoex">
                        <span name="attr_cmb_notes"></span>
                        <textarea name="attr_cmb_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes" title="@{cmb_notes}"></textarea>
                    </div>
                </div>
            </div> <!-- END BABS -->
            <div class="attackmods"> <!-- ATTACK MODS (MELEE RANGED) -->
                <input class="options-flag melee" name="attr_options-flag-melee" type="checkbox" value="1" data-i18n-title="show-hide-options" title="Show/hide options"><span>y</span>
                <input class="options-flag ranged" name="attr_options-flag-ranged" type="checkbox" value="1" data-i18n-title="show-hide-options" title="Show/hide options"><span>y</span>
                <div class="myrow">
                    <div class="blacklabel melee">
                        <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                        <div class="blackbgrd">
                            <button class="myrol big only" type="roll" name="MeleeRoll" data-i18n-title="basic-melee-attack-roll" title="Basic Melee Attack Roll" value="@{whispertype} &{template:default} {{name=^{melee}}} {{type=attack}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20cs20+@{melee_mod}[MOD]+@{rollmod_attack}[BONUS]]]}} {{shownotes=@{rollnotes_attack}}} {{notes=@{melee_notes}}}"><span data-i18n="melee">Melee</span></button>
                        </div>
                    </div>
                    <div class="boxed greybg">
                        <span name="attr_melee_mod" class="pseudoattr" title="@{melee_mod}"></span>
                    </div>
                    <div class="boxed">
                        <input type="number" name="attr_melee_bonus" class="boxed" value="0" title="@{melee_bonus}" />
                    </div>
                    <div class="blacklabel ranged">
                        <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                        <div class="blackbgrd">
                            <button class="myrol big only" type="roll" name="RangedRoll" data-i18n-title="basic-ranged-attack-roll" title="Basic Ranged Attack Roll" value="@{whispertype} &{template:default} {{name=^{ranged}}} {{type=attack}} {{showchar=@{rollshowchar}}} {{charname=@{character_name}}} {{roll=[[1d20cs10+@{ranged_mod}[MOD]+@{rollmod_attack}[BONUS]]]}} {{shownotes=@{rollnotes_attack}}} {{notes=@{ranged_notes}}}"><span data-i18n="ranged">Ranged</span></button>
                        </div>
                    </div>
                    <div class="boxed greybg">
                        <span name="attr_ranged_mod" class="pseudoattr" title="@{ranged_mod}"></span>
                    </div>
                    <div class="boxed">
                        <input type="number" name="attr_ranged_bonus" class="boxed" value="0" title="@{ranged_bonus}" />
                    </div>
                </div>
                <div class="myrow labline bottom">
                    <span class="lab" style="margin-left: 125px;" data-i18n="total" data-i18n-title="total" title="Total">Total</span>
                    <span class="lab" data-i18n="temp" data-i18n-title="temp-adjustment" title="Temp Adjustment">Temp</span>
                    <span class="lab" style="margin-left: 128px;" data-i18n="total" data-i18n-title="total" title="Total">Total</span>
                    <span class="lab" data-i18n="temp" data-i18n-title="temp-adjustment" title="Temp Adjustment">Temp</span>
                </div>
                <div class="options-melee">
                    <div class="myrow">
                        <span class="spacer" data-i18n="melee">Melee</span>
                        <span class="spacer">=</span>
                        <div class="boxed greybg">
                            <span name="attr_bab" class="pseudoattr" title="@{bab}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_melee_ability_mod" class="pseudoattr" title="@{melee_ability_mod}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_bab_size" class="pseudoattr" title="@{bab_size}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed">
                            <input type="number" name="attr_melee_misc" class="boxed" value="0" title="@{melee_misc}" />
                        </div>
                    </div>
                    <div class="myrow labline bottom">
                        <span class="spacer invisible" data-i18n="melee">Melee</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="bab-u" data-i18n-title="base-attack-bonus" title="Base Attack Bonus">BAB</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="ability" data-i18n-title="ability-modifier" title="Ability Modifier">Ability</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="size" data-i18n-title="size-modifier" title="Size Modifier">Size</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="misc" data-i18n-title="misc-modifier" title="Misc Modifier">Misc</span>
                    </div>
                    <div class="autoex">
                        <span name="attr_melee_notes"></span>
                        <textarea name="attr_melee_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes" title="@{melee_notes}"></textarea>
                    </div>
                </div>
                <div class="options-ranged">
                    <div class="myrow right">
                        <span class="spacer" data-i18n="ranged">Ranged</span>
                        <span class="spacer">=</span>
                        <div class="boxed greybg">
                            <span name="attr_bab" class="pseudoattr" title="@{bab}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_ranged_ability_mod" class="pseudoattr" title="@{ranged_ability_mod}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_bab_size" class="pseudoattr" title="@{bab_size}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed">
                            <input type="number" name="attr_ranged_misc" class="boxed" value="0" title="@{ranged_misc}" />
                        </div>
                    </div>
                    <div class="myrow right labline bottom">
                        <span class="spacer invisible" data-i18n="ranged">Ranged</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="bab-u" data-i18n-title="base-attack-bonus" title="Base Attack Bonus">BAB</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="ability" data-i18n-title="ability-modifier" title="Ability Modifier">Ability</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="size" data-i18n-title="size-modifier" title="Size Modifier">Size</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="misc" data-i18n-title="misc-modifier" title="Misc Modifier">Misc</span>
                    </div>
                    <div class="autoex">
                        <span name="attr_ranged_notes"></span>
                        <textarea name="attr_ranged_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes" title="@{ranged_notes}"></textarea>
                    </div>
                </div>
            </div>  <!-- END ATTACK MODS (MELEE RANGED) -->
            <div class="defenses"> <!-- DEFENSES -->
                <input class="options-flag cmd" name="attr_options-flag-cmd" type="checkbox" value="1" data-i18n-title="show-hide-options" title="Show/hide options"><span>y</span>
                <input class="options-flag sr" name="attr_options-flag-sr" type="checkbox" value="1" data-i18n-title="show-hide-options" title="Show/hide options"><span>i</span>
                <div class="myrow">
                    <div class="blacklabel cmd">
                        <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                        <div class="blackbgrd">
                            <span class="big only" data-i18n="cmd-u" data-i18n-bonus="combat-maneuver-defense" title="Combat Maneuver Defense">CMD</span>
                        </div>
                    </div>
                    <div class="boxed greybg">
                        <span name="attr_cmd" class="pseudoattr" title="@{cmd}"></span>
                    </div>
                    <div class="boxed">
                        <input type="number" name="attr_cmd_bonus" class="boxed" value="0" title="@{cmd_bonus}" />
                    </div>
                    <div class="blacklabel sr">
                        <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                        <div class="blackbgrd">
                            <span class="big only" data-i18n="spell-resistance">Spell Resistance</span>
                        </div>
                    </div>
                    <div class="boxed">
                        <input type="number" name="attr_sr" class="boxed" value="0" title="@{sr}" />
                    </div>
                </div>
                <div class="myrow labline bottom">
                    <span class="lab" style="margin-left: 86px;" data-i18n="total" data-i18n-title="total" title="Total">Total</span>
                    <span class="lab" data-i18n="temp" data-i18n-title="temp-adjustment" title="Temp Adjustment">Temp</span>
                </div>
                <div class="options-cmd">
                    <div class="myrow">
                        <span class="spacer">=</span>
                        <div class="boxed greybg">
                            <span name="attr_bab" class="pseudoattr" title="@{bab}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_strength_mod" class="pseudoattr" title="@{strength_mod}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_dexterity_mod" class="pseudoattr" title="@{dexterity_mod}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_cmb_size" class="pseudoattr" title="@{cmb_size}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_ac_dodge" class="pseudoattr" title="@{ac_dodge}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed greybg">
                            <span name="attr_ac_deflection" class="pseudoattr" title="@{ac_deflection}"></span>
                        </div>
                        <span class="spacer">+</span>
                        <div class="boxed">
                            <input type="number" name="attr_cmd_misc" class="boxed" value="0" title="@{cmd_misc}" />
                        </div>
                        <span class="spacer">+</span>
                        <span class="spacer">10</span>
                    </div>
                    <div class="myrow labline bottom">
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="bab-u" data-i18n-title="base-attack-bonus" title="Base Attack Bonus">BAB</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="str-u" data-i18n-title="strength-modifier" title="Strength Modifier">STR</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="dex-u" data-i18n-title="dexterity-modifier" title="Dexterity Modifier">DEX</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="size" data-i18n-title="size-modifier" title="Size Modifier">Size</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="dodge" data-i18n-title="dodge-bonus" title="Dodge bonus">Dodge</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="deflection" data-i18n-title="deflection-modifier" title="Deflection Modifier">Deflection</span>
                        <span class="spacer"></span>
                        <span class="lab" data-i18n="misc" data-i18n-title="misc-modifier" title="Misc Modifier">Misc</span>
                    </div>
                    <div class="autoex">
                        <span name="attr_cmd_notes"></span>
                        <textarea name="attr_cmd_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes" title="@{cmd_notes}"></textarea>
                    </div>
                </div>
                <div class="options-sr">
                    <div class="autoex">
                        <span name="attr_sr_snotes"></span>
                        <textarea name="attr_sr_notes" spellcheck="false" data-i18n-placeholder="sr-notes" placeholder="SR Notes" title="@{sr_notes}"></textarea>
                    </div>
                </div>
            </div> <!-- END DEFENSES -->
            <div class="attacks"> <!-- ATTACKS -->
                <div class="myrow right">
                    <div class="blacklabel">
                        <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                        <div class="blackbgrd weapon">
                            <span class="big only" data-i18n="weapons-attacks">Weapons / Attacks</span>
                        </div>
                        <div class="blackbgrd atk">
                            <span class="med only" data-i18n="atk-u" >ATK</span>
                        </div>
                        <div class="blackbgrd damage">
                            <span class="med only" data-i18n="dmg-u" >DMG</span>
                        </div>
                        <div class="blackbgrd ammo">
                            <span class="med only" data-i18n="ammo" >Ammo</span>
                        </div>
                    </div>
                </div>
                <div class="bordered titled inbox">
                    <!-- DEBUG LAYOUT -->
                    <!-- <div class="attack right">
                        <input class="options-flag" name="attr_options-flag" type="checkbox" data-i18n-title="show-hide-options" title="Show/hide options" checked="checked"><span>y</span>
                        <div class="myrow right">
                            <button class="myrol" type="roll" name="AtkDmgRoll" data-i18n-title="attack-damage-roll" title="Attack & Damage roll" value="/r 1d20">
                                <span class="pseudoattr greybg underlined weapon">Layout test</span>
                            </button>
                            <button class="myrol" type="roll" name="AtkRoll" data-i18n-title="attack-roll" title="Attack roll" value="/r 1d20">
                                <span class="pseudoattr greybg underlined atk">+6</span>
                            </button>
                            <button class="myrol" type="roll" name="DmgRoll" data-i18n-title="attack-roll" title="Damage roll" value="/r 1d20">
                                <span class="pseudoattr greybg underlined damage">1d12+4</span>
                            </button>
                            <input type="number" class="underlined ammo" name="attr_atkammo" value="0" title="@{atkammo}" />
                        </div>
                    </div> -->
                    <div class="myrow"> <!-- REPEATING ATTACK -->
                        <fieldset class="repeating_attacks">
                            <div class="attack right">
                                <input class="options-flag" name="attr_options-flag" type="checkbox" data-i18n-title="show-hide-options" title="Show/hide options" checked="checked"><span>y</span>
                                <div class="myrow right">
                                    <button class="myrol" type="roll" name="AtkDmgRoll" data-i18n-title="attack-damage-roll" title="Attack & Damage roll" value="@{rollbase}">
                                        <span class="pseudoattr greybg underlined weapon" name="attr_atkdisplay"></span>
                                    </button>
                                    <button class="myrol" type="roll" name="AtkRoll" data-i18n-title="attack-roll" title="Attack roll" value="@{rollbase_atk}">
                                        <span class="pseudoattr greybg underlined atk" name="attr_atkbonusdisplay"></span>
                                    </button>
                                    <button class="myrol" type="roll" name="DmgRoll" data-i18n-title="damage-roll" title="Damage roll" value="@{rollbase_dmg}">
                                        <span class="pseudoattr greybg underlined damage" name="attr_atkdmgdisplay"></span>
                                    </button>
                                    <input type="number" class="underlined ammo" name="attr_atkammo" value="0" title="@{atkammo}" />
                                </div>
                                <div class="options right">
                                    <div class="myrow">
                                        <span class="lab" data-i18n="name">Name</span>
                                        <input type="text" name="attr_atkname" class="underlined name" spellcheck="false" data-i18n-placeholder="name" placeholder="Name" title="@{atkname}" />
                                    </div>
                                    <div class="myrow">
                                        <input class="pseudocheck" type="checkbox" name="attr_atkflag" value="{{attack=1}}" title="@{atkflag}" checked="checked" /><span class="mleft"></span>
                                        <span class="lab atk" data-i18n="attack:">Attack:</span>
                                        <select class="underlined type" name="attr_atktype" title="@{atktype}">
                                            <option value="melee" selected="selected" data-i18n="melee">Melee</option>
                                            <option value="ranged" data-i18n="ranged">Ranged</option>
                                            <option value="cmb" data-i18n="cmb-u">CMB</option>
                                            <option value="strength" data-i18n="str-u">STR</option>
                                            <option value="dexterity" data-i18n="dex-u">DEX</option>
                                            <option value="constitution" data-i18n="con-u">CON</option>
                                            <option value="intelligence" data-i18n="int-u">INT</option>
                                            <option value="wisdom" data-i18n="wis-u">WIS</option>
                                            <option value="charisma" data-i18n="cha-u">CHA</option>
                                            <option value="0">-</option>
                                        </select>
                                        <span class="lab">+</span>
                                        <input type="text" class="underlined dmgbase" name="attr_atkmod" value="0" spellcheck="false" title="@{atkmod}" />
                                        <span class="lab" data-i18n="vs-u">VS</span>
                                        <select class="underlined vs" name="attr_atkvs" title="@{atkvs}">
                                            <option value="ac" selected="selected" data-i18n="ac-u">AC</option>
                                            <option value="touch" data-i18n="touch">Touch</option>
                                            <option value="flatfooted" data-i18n="flat-footed">Flat-footed</option>
                                            <option value="fftouch" data-i18n="ff-touch">FF Touch</option>
                                            <option value="cmd" data-i18n="cmd-u">CMD</option>
                                            <option value="cmb" data-i18n="cmb-opposed">CMB</option>
                                            <option value="other" data-i18n="other">Other</option>
                                        </select>
                                    </div>
                                    <div class="myrow padindent">
                                        <span class="lab atk" data-i18n="critical:" data-i18n-title="critical-range" title="Critical Range">Critical:</span>
                                        <input type="number" class="underlined" name="attr_atkcritrange" value="20" title="@{atkcritrange}" />
                                        <span class="lab" data-i18n-title="critical-multiplier" title="Critical Multiplier">X</span>
                                        <input type="number" class="underlined" name="attr_atkcritmulti" value="2" title="@{atkcritmulti}" />
                                        <span class="lab atk right" data-i18n="range:">Range:</span>
                                        <input type="text" name="attr_atkrange" class="underlined range" spellcheck="false" data-i18n-placeholder="range-place" placeholder="10 feet" />
                                    </div>
                                    <div class="myrow">
                                        <input class="pseudocheck" type="checkbox" name="attr_dmgflag" value="{{damage=1}} {{dmg1flag=1}}" title="@{dmgflag}" checked="checked" /><span class="mleft"></span>
                                        <span class="lab atk" data-i18n="damage:">Damage:</span>
                                        <input type="text" name="attr_dmgbase" class="underlined dmgbase" spellcheck="false" placeholder="1d6" title="@{dmgbase}" />
                                        <span class="lab">+</span>
                                        <select class="underlined" name="attr_dmgattr" title="@{dmgattr}">
                                            <option value="strength" selected="selected" data-i18n="str-u">STR</option>
                                            <option value="dexterity" data-i18n="dex-u">DEX</option>
                                            <option value="constitution" data-i18n="con-u">CON</option>
                                            <option value="intelligence" data-i18n="int-u">INT</option>
                                            <option value="wisdom" data-i18n="wis-u">WIS</option>
                                            <option value="charisma" data-i18n="cha-u">CHA</option>
                                            <option value="0">-</option>
                                        </select>
                                        <span class="lab">+</span>
                                        <input type="text" name="attr_dmgmod" class="underlined dmgbase" spellcheck="false" placeholder="0" title="@{dmgmod}" />
                                        <span class="lab right typ" data-i18n="type:">Type:</span>
                                        <input type="text" name="attr_dmgtype" class="underlined dmgtype" spellcheck="false" data-i18n-placeholder="slashing" placeholder="Slashing" title="@{dmgtype}" />
                                    </div>
                                    <div class="myrow">
                                        <input class="pseudocheck" type="checkbox" name="attr_dmg2flag" value="{{damage=1}} {{dmg2flag=1}}" title="@{dmg2flag}" /><span class="mleft"></span>
                                        <span class="lab atk" data-i18n="damage2:">Damage2:</span>
                                        <input type="text" name="attr_dmg2base" class="underlined dmgbase" spellcheck="false" placeholder="1d4" title="@{dmg2base}" />
                                        <span class="lab">+</span>
                                        <select class="underlined" name="attr_dmg2attr" title="@{dmg2attr}">
                                            <option value="strength" data-i18n="str-u">STR</option>
                                            <option value="dexterity" data-i18n="dex-u">DEX</option>
                                            <option value="constitution" data-i18n="con-u">CON</option>
                                            <option value="intelligence" data-i18n="int-u">INT</option>
                                            <option value="wisdom" data-i18n="wis-u">WIS</option>
                                            <option value="charisma" data-i18n="cha-u">CHA</option>
                                            <option value="0" selected="selected">-</option>
                                        </select>
                                        <span class="lab">+</span>
                                        <input type="text" name="attr_dmg2mod" class="underlined dmgbase" spellcheck="false" placeholder="0" title="@{dmg2mod}" />
                                        <span class="lab right typ" data-i18n="type:">Type:</span>
                                        <input type="text" name="attr_dmg2type" class="underlined dmgtype" spellcheck="false" data-i18n-placeholder="fire" placeholder="Fire" title="@{dmg2type}" />
                                    </div>
                                    <div class="myrow">
                                        <input class="pseudocheck" type="checkbox" name="attr_descflag" value="{{descflag=1}}" title="@{descflag}" /><span class="mleft"></span>
                                        <span class="lab atk" data-i18n="description:">Description:</span>
                                        <div class="autoex">
                                            <span name="attr_atkdesc"></span>
                                            <textarea name="attr_atkdesc" class="underlined" spellcheck="false" data-i18n-placeholder="description" placeholder="Description" title="@{atkdesc}"></textarea>
                                        </div>
                                    </div>
                                    <span class="lab" data-i18n="notes:">Notes:</span>
                                    <div class="autoex">
                                        <span name="attr_notes"></span>
                                        <textarea name="attr_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes" title="@{notes}"></textarea>
                                    </div>
                                </div>
                                <input type="hidden" name="attr_rollbase">
                                <input type="hidden" name="attr_rollbase_atk">
                                <input type="hidden" name="attr_rollbase_dmg">
                                <button type="roll" name="roll_attack_atk" style="display: none;" value="@{rollbase_atk}"></button>
                                <button type="roll" name="roll_attack_dmg" style="display: none;" value="@{rollbase_dmg}"></button>
                            </div>
                        </fieldset>
                    </div> <!-- END REPEATING ATTACK -->
                </div>
            </div> <!-- END ATTACKS -->
        </div>  <!-- END tab1 col1 -->
        <div class="colhalf"> <!-- tab1 col2 -->
            <div class="myrow center skills">
                <div class="blacklabel">
                    <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                    <div class="blackbgrd">
                        <span class="big only" data-i18n="skills">skills</span>
                    </div>
                    <img class="brdright" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdright.png" />
                </div>
                <div class="bordered titled inbox">
                    <div class="myrow skill">
                        skill
                    </div>
                    <div class="myrow skill">
                        skill
                    </div>
                    <div class="myrow skill">
                        skill
                    </div>
                    <div class="myrow skill">
                        skill
                    </div>
                    <div class="myrow skill">
                        skill
                    </div>
                    <div class="myrow skill">
                        skill
                    </div>
                    <div class="myrow skill">
                        skill
                    </div>
                </div>
            </div>
            <div class="myrow center languages"> <!-- LANGUAGES -->
                <div class="blacklabel">
                    <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                    <div class="blackbgrd">
                        <span class="big only" data-i18n="languages">Languages</span>
                    </div>
                    <img class="brdright" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdright.png" />
                </div>
                <div class="bordered titled inbox">
                    <div class="autoex">
                        <span name="attr_languages"></span>
                        <textarea name="attr_languages" spellcheck="false" data-i18n-placeholder="languages" placeholder="Languages" title="@{languages}"></textarea>
                    </div>
                </div>
            </div> <!-- END LANGUAGES -->
        </div>  <!-- END tab1 col2 -->
    </div> <!-- END TAB MAIN -->
    <div class="tabadd"> <!-- TAB ADDITIONNAL -->
        <div class="col2third">
            <div class="acitems"> <!-- AC ITEMS -->
                <div class="myrow right">
                    <div class="blacklabel">
                        <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                        <div class="blackbgrd item">
                            <span class="big only" data-i18n="ac-items">AC Items</span>
                        </div>
                        <div class="blackbgrd equipped">
                            <span class="med only" data-i18n="eq" data-i18n-title="equipped" title="Equipped">Eq</span>
                        </div>
                        <div class="blackbgrd ac">
                            <span class="med only" data-i18n="ac-u" data-i18n-title="ac-bonus" title="AC Bonus">AC</span>
                        </div>
                        <div class="blackbgrd flat">
                            <span class="med only" data-i18n="flat" data-i18n-title="flat-footed-bonus" title="Flat-footed Bonus">Flat</span>
                        </div>
                        <div class="blackbgrd touch">
                            <span class="med only" data-i18n="touch" data-i18n-title="touch-bonus" title="Touch Bonus">Touch</span>
                        </div>
                        <div class="blackbgrd type">
                            <span class="med only" data-i18n="type">Type</span>
                        </div>
                        <div class="blackbgrd check">
                            <span class="med only" data-i18n="check" data-i18n-title="check-penalty" title="Check Penalty">Check</span>
                        </div>
                        <div class="blackbgrd max">
                            <span class="med only" data-i18n="dex" data-i18n-title="max-dex-bonus" title="Maximum Dex Bonus">Dex</span>
                        </div>
                        <div class="blackbgrd spell">
                            <span class="med only" data-i18n="spell" data-i18n-title="spell-failure" title="Spell Failure">Spell</span>
                        </div>
                    </div>
                </div>
                <div class="bordered titled inboxright">
                    <div class="myrow"> <!-- REPEATING AC ITEMS -->
                        <fieldset class="repeating_acitems">
                            <div class="acitem right">
                                <input class="options-flag" name="attr_options-flag" type="checkbox" data-i18n-title="show-hide-notes" title="Show/hide notes"><span>i</span>
                                <div class="myrow right">
                                    <input type="text" name="attr_name" spellcheck="false" class="underlined" title="@{repeating_acitems_name}" data-i18n-placeholder="item" placeholder="Item" />
                                    <input class="pseudocheck" type="checkbox" name="attr_equipped" value="1" title="@{repeating_acitems_equipped}" /><span class="mleft"></span>
                                    <input type="number" name="attr_ac_bonus" value="0" class="underlined" title="@{repeating_acitems_ac_bonus}" />
                                    <input type="number" name="attr_flatfooted_bonus" value="0" class="underlined" title="@{repeating_acitems_flatfooted_bonus}" />
                                    <input type="number" name="attr_touch_bonus" value="0" class="underlined" title="@{repeating_acitems_touch_bonus}" />
                                    <select name="attr_type" title="@{repeating_acitems_type}">
                                        <option value="light" data-i18n="light">Light</option>
                                        <option value="medium" data-i18n="medium" selected="selected">Medium</option>
                                        <option value="heavy" data-i18n="heavy">Heavy</option>
                                        <option value="shield" data-i18n="shield">Shield</option>
                                        <option value="misc" data-i18n="misc">Misc</option>
                                    </select>
                                    <input type="number" name="attr_check_penalty" value="0" class="underlined" title="@{repeating_acitems_check_penalty}" />
                                    <input type="number" name="attr_max_dex_bonus" value="0" class="underlined" title="@{repeating_acitems_max_dex_bonus}" />
                                    <input type="number" name="attr_spell_failure" value="0" class="underlined" title="@{repeating_acitems_spell_failure}" />
                                </div>
                                <div class="options right">
                                    <div class="autoex">
                                        <span name="attr_notes"></span>
                                        <textarea name="attr_notes" spellcheck="false" data-i18n-placeholder="notes" placeholder="Notes"></textarea>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </div> <!-- END REPEATING AC ITEMS -->
                    <div class="myrow right" style="margin-top: 3px;"> <!-- Ac Items Totals -->
                        <span class="lab bold totals" data-i18n="totals-u">TOTALS</span>
                        <span class="lab shield" data-i18n="shield">Shield</span>
                        <div class="boxed greybg">
                            <span name="attr_ac_shield" class="pseudoattr" title="@{ac_shield}"></span>
                        </div>
                        <span class="lab armor" data-i18n="armor">Armor</span>
                        <div class="boxed greybg">
                            <span name="attr_ac_armor" class="pseudoattr" title="@{ac_armor}"></span>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_ac_flatfooted_bonus" class="pseudoattr" title="@{ac_flatfooted_bonus}"></span>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_ac_touch_bonus" class="pseudoattr" title="@{ac_touch_bonus}"></span>
                        </div>
                        <span class="spacer type"></span>
                        <div class="boxed greybg">
                            <span name="attr_armor_check_penalty" class="pseudoattr" title="@{armor_check_penalty}"></span>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_ac_ability_maximum" class="pseudoattr" title="@{ac_ability_maximum}"></span>
                        </div>
                        <div class="boxed greybg">
                            <span name="attr_armor_spell_failure" class="pseudoattr" title="@{armor_spell_failure}"></span>
                        </div>
                    </div> <!-- End Ac Items Totals -->
                </div>
            </div> <!-- END AC ITEMS -->
        </div>
        <div class="col1third">stuff</div>
    </div> <!-- END TAB ADDITIONNAL -->
    <div class="tabspell"> <!-- TAB SPELLS -->
        SPELLS AND MAGIC
    </div> <!-- END TAB SPELLS -->
    <div class="tabconf"> <!-- TAB CONFIGURATION -->
        <div class="col1third">
            <div class="blacklabel">
                <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                <div class="blackbgrd">
                    <span class="big only" data-i18n="class">class</span>
                </div>
                <img class="brdright" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdright.png" />
            </div>
            <div class="bordered titled inbox">
                <span data-i18n="hit-die">Hit Die</span>:
                    <select name="attr_hitdietype" title="@{hitdietype}">
                        <option value="4">D4</option>
                        <option value="6">D6</option>
                        <option value="8" selected="selected">D8</option>
                        <option value="10">D10</option>
                        <option value="12">D12</option>
                    </select>
                <span class="block" data-i18n="armor-class:">Armor Class:</span>
                    <div class="myrow padindent">
                        <span data-i18n="primary-ability-modifier">Primary ability modifier</span>:
                        <select name="attr_ac_ability_primary" title="@{ac_ability_primary}">
                            <option value="strength" data-i18n="strength">Strength</option>
                            <option value="dexterity" data-i18n="dexterity" selected="selected">Dexterity</option>
                            <option value="constitution" data-i18n="constitution">Constitution</option>
                            <option value="intelligence" data-i18n="intelligence">Intelligence</option>
                            <option value="wisdom" data-i18n="wisdom">Wisdom</option>
                            <option value="charisma" data-i18n="charisma">Charisma</option>
                        </select>
                    </div>
                    <div class="myrow padindent">
                        <span data-i18n="secondary-ability-modifier">Secondary ability modifier</span>:
                        <select name="attr_ac_ability_secondary" title="@{ac_ability_secondary}">
                            <option value="none" data-i18n="none" selected="selected">None</option>
                            <option value="strength" data-i18n="strength">Strength</option>
                            <option value="dexterity" data-i18n="dexterity">Dexterity</option>
                            <option value="constitution" data-i18n="constitution">Constitution</option>
                            <option value="intelligence" data-i18n="intelligence">Intelligence</option>
                            <option value="wisdom" data-i18n="wisdom">Wisdom</option>
                            <option value="charisma" data-i18n="charisma">Charisma</option>
                        </select>
                    </div>
                    <div class="myrow padindent"><span data-i18n="dodge-bonus">Dodge bonus</span>:<input type="number" name="attr_ac_dodge" value="0" class="sml" title="@{ac_dodge}" /></div>
                    <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_ac_noflatflooted" value="1" title="@{ac_noflatflooted}" /><span class="mleft"></span><span data-i18n="cannot-be-caught-flat-footed">Cannot be caught Flat-Footed</span></div>
                    <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_ac_touchshield" value="1" title="@{ac_touchshield}" /><span class="mleft"></span><span data-i18n="shield-bonus-added-to-touch-ac">Shield bonus added to Touch AC</span></div>
                <span class="block" data-i18n="saving-throws:">Saving Throws:</span>
                    <div class="myrow padindent"><span data-i18n="base-fortitude">Base Fortitude</span>:<input type="number" name="attr_fortitude_base" value="0" class="sml" title="@{fortitude_base}" /></div>
                    <div class="myrow padindent">
                        <span data-i18n="fortitude-ability">Fortitude Ability</span>:
                        <select name="attr_fortitude_ability" title="@{fortitude_ability}">
                            <option value="strength" data-i18n="strength">Strength</option>
                            <option value="dexterity" data-i18n="dexterity">Dexterity</option>
                            <option value="constitution" data-i18n="constitution" selected="selected">Constitution</option>
                            <option value="intelligence" data-i18n="intelligence">Intelligence</option>
                            <option value="wisdom" data-i18n="wisdom">Wisdom</option>
                            <option value="charisma" data-i18n="charisma">Charisma</option>
                        </select>
                    </div>
                    <div class="myrow padindent"><span data-i18n="base-reflex">Base Reflex</span>:<input type="number" name="attr_reflex_base" value="0" class="sml" title="@{reflex_base}" /></div>
                    <div class="myrow padindent">
                        <span data-i18n="reflex-ability">Reflex Ability</span>:
                        <select name="attr_reflex_ability" title="@{reflex_ability}">
                            <option value="strength" data-i18n="strength">Strength</option>
                            <option value="dexterity" data-i18n="dexterity" selected="selected">Dexterity</option>
                            <option value="constitution" data-i18n="constitution">Constitution</option>
                            <option value="intelligence" data-i18n="intelligence">Intelligence</option>
                            <option value="wisdom" data-i18n="wisdom">Wisdom</option>
                            <option value="charisma" data-i18n="charisma">Charisma</option>
                        </select>
                    </div>
                    <div class="myrow padindent"><span data-i18n="base-will">Base Will</span>:<input type="number" name="attr_will_base" value="0" class="sml" title="@{will_base}" /></div>
                    <div class="myrow padindent">
                        <span data-i18n="will-ability">Will Ability</span>:
                        <select name="attr_will_ability" title="@{will_ability}">
                            <option value="strength" data-i18n="strength">Strength</option>
                            <option value="dexterity" data-i18n="dexterity">Dexterity</option>
                            <option value="constitution" data-i18n="constitution">Constitution</option>
                            <option value="intelligence" data-i18n="intelligence">Intelligence</option>
                            <option value="wisdom" data-i18n="wisdom" selected="selected">Wisdom</option>
                            <option value="charisma" data-i18n="charisma">Charisma</option>
                        </select>
                    </div>
                <span class="block" data-i18n="attacks:">Attacks:</span>
                    <div class="myrow padindent">
                        <span data-i18n="cmb-ability">CMB Ability</span>:
                        <select name="attr_cmb_ability" title="@{cmb_ability}">
                            <option value="strength" data-i18n="strength" selected="selected">Strength</option>
                            <option value="dexterity" data-i18n="dexterity">Dexterity</option>
                            <option value="constitution" data-i18n="constitution">Constitution</option>
                            <option value="intelligence" data-i18n="intelligence">Intelligence</option>
                            <option value="wisdom" data-i18n="wisdom">Wisdom</option>
                            <option value="charisma" data-i18n="charisma">Charisma</option>
                        </select>
                    </div>
                    <div class="myrow padindent">
                        <span data-i18n="melee-ability">Melee Ability</span>:
                        <select name="attr_melee_ability" title="@{melee_ability}">
                            <option value="strength" data-i18n="strength" selected="selected">Strength</option>
                            <option value="dexterity" data-i18n="dexterity">Dexterity</option>
                            <option value="constitution" data-i18n="constitution">Constitution</option>
                            <option value="intelligence" data-i18n="intelligence">Intelligence</option>
                            <option value="wisdom" data-i18n="wisdom">Wisdom</option>
                            <option value="charisma" data-i18n="charisma">Charisma</option>
                        </select>
                    </div>
                    <div class="myrow padindent">
                        <span data-i18n="ranged-ability">Ranged Ability</span>:
                        <select name="attr_ranged_ability" title="@{ranged_ability}">
                            <option value="strength" data-i18n="strength">Strength</option>
                            <option value="dexterity" data-i18n="dexterity" selected="selected">Dexterity</option>
                            <option value="constitution" data-i18n="constitution">Constitution</option>
                            <option value="intelligence" data-i18n="intelligence">Intelligence</option>
                            <option value="wisdom" data-i18n="wisdom">Wisdom</option>
                            <option value="charisma" data-i18n="charisma">Charisma</option>
                        </select>
                    </div>
            </div>
        </div>
        <div class="col1third">
            <div class="blacklabel">
                <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                <div class="blackbgrd">
                    <span class="big only" data-i18n="rolls">rolls</span>
                </div>
                <img class="brdright" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdright.png" />
            </div>
            <div class="bordered titled inbox">
                <input class="pseudocheck" type="checkbox" name="attr_rollshowchar" value="[[1]]" title="@{rollshowchar}" checked="checked" /><span class="mleft"></span><span data-i18n="show-character-name">Show character name</span>
                <div class="myrow">
                    <span data-i18n="whisp-rolls-gm:">Whisper Rolls to GM:</span>
                    <select name="attr_whispertype" title="@{whispertype}">
                        <option value="" data-i18n="never-whisper-roll" selected="selected">Never Whisper Rolls</option>
                        <!-- <option value="@{whispertoggle}" data-i18n="toggle-roll-whisper">Whisper Toggle</option> -->
                        <option value="?{Whisper?|Public Roll,|Whisper Roll,/w gm }" data-i18n="query-whisper-roll">Query Whisper</option>
                        <option value="/w gm " data-i18n="always-whisper-roll">Always Whisper Rolls</option>
                    </select>
                </div>
                <span class="block" data-i18n="query-modifier">Query modifier for:</span>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollmod_ability" value="?{Modifier|0}" title="@{rollmod_ability}" /><span class="mleft"></span><span data-i18n="ability-rolls">Ability Rolls</span></div>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollmod_initiative" value="?{Modifier|0}" title="@{rollmod_initiative}" /><span class="mleft"></span><span data-i18n="initiative-rolls">Initiative Rolls</span></div>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollmod_save" value="?{Modifier|0}" title="@{rollmod_save}" /><span class="mleft"></span><span data-i18n="save-rolls">Saving Throw Rolls</span></div>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollmod_skill" value="?{Modifier|0}" title="@{rollmod_skill}" /><span class="mleft"></span><span data-i18n="skill-rolls">Skill Rolls</span></div>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollmod_attack" value="?{Modifier|0}" title="@{rollmod_attack}" /><span class="mleft"></span><span data-i18n="attack-rolls">Attack & CMB Rolls</span></div>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollmod_damage" value="?{Modifier|0}" title="@{rollmod_damage}" /><span class="mleft"></span><span data-i18n="damage-rolls">Damage Rolls</span></div>
                <span class="block" data-i18n="show-notes-in">Show Notes in:</span>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollnotes_ability" value="1" title="@{rollnotes_ability}" /><span class="mleft"></span><span data-i18n="ability-rolls">Ability Rolls</span></div>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollnotes_initiative" value="1" title="@{rollnotes_initiative}" /><span class="mleft"></span><span data-i18n="initiative-rolls">Initiative Rolls</span></div>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollnotes_save" value="1" title="@{rollnotes_save}" /><span class="mleft"></span><span data-i18n="save-rolls">Saving Throw Rolls</span></div>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollnotes_skill" value="1" title="@{rollnotes_skill}" /><span class="mleft"></span><span data-i18n="skill-rolls">Skill Rolls</span></div>
                <div class="myrow padindent"><input class="pseudocheck" type="checkbox" name="attr_rollnotes_attack" value="1" title="@{rollnotes_attack}" /><span class="mleft"></span><span data-i18n="attack-rolls">Attack & CMB Rolls</span></div>
            </div>
        </div>
        <div class="col1third">
            <div class="blacklabel">
                <img class="brdleft" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdleft.png" />
                <div class="blackbgrd">
                    <span class="big only">some other stuff</span>
                </div>
                <img class="brdright" src="https://raw.githubusercontent.com/NathaTerrien/roll20-wip/master/PFO/img/brdright.png" />
            </div>
            <div class="bordered titled inbox">
                <span class="block">Some configuration stuff</span>
            </div>
            <div class="myrow right">
                <span data-i18n="version">Version</span>&nbsp;<span name="attr_version"></span>
            </div>
        </div>
    </div> <!-- END TAB CONFIGURATION -->
</div>

<!-- HIDDEN ATTRIBUTES -->
<input type="hidden" name="none_mod" value="0" />
<!-- HIDDEN TRANSLATION TEXT -->
<div style="display: none;">
    <span data-i18n="combat-maneuver">Combat Maneuver</span>
</div>

<!-- ROLL TEMPLATES -->
    <!-- TODO -->

<!-- WORKERS -->
<script type="text/worker">
    /* === GLOBAL VARIABLES === */

    /* === EVENTS === */

    // === Version handling
    on("sheet:opened", function() {
        versioning();
    });

    // === Abilities
    on("change:strength_base change:strength_bonus", function() {
        update_attr("strength");
    });
    on("change:strength", function() {
        update_mod("strength");
    });
    on("change:dexterity_base change:dexterity_bonus", function() {
        update_attr("dexterity");
    });
    on("change:dexterity", function() {
        update_mod("dexterity");
    });
    on("change:constitution_base change:constitution_bonus", function() {
        update_attr("constitution");
    });
    on("change:constitution", function() {
        update_mod("constitution");
    });
    on("change:intelligence_base change:intelligence_bonus", function() {
        update_attr("intelligence");
    });
    on("change:intelligence", function() {
        update_mod("intelligence");
    });
    on("change:wisdom_base change:wisdom_bonus", function() {
        update_attr("wisdom");
    });
    on("change:wisdom", function() {
        update_mod("wisdom");
    });
    on("change:charisma_base change:charisma_bonus", function() {
        update_attr("charisma");
    });
    on("change:charisma", function() {
        update_mod("charisma");
    });

    // === Size
    on("change:size", function(e){
        update_size(e.newValue);
    });

    // === Mods
    on("change:strength_mod", function() {
        update_ac_ability("strength");
        update_flex_ability("strength","");
        update_cmd();
        update_attacks("strength","");
    });
    on("change:dexterity_mod", function() {
        update_ac_ability("dexterity");
        update_initiative();
        update_flex_ability("dexterity","");
        update_cmd();
        update_attacks("dexterity","");
    });
    on("change:constitution_mod", function() {
        update_ac_ability("constitution");
        update_flex_ability("constitution","");
        update_attacks("constitution","");
    });
    on("change:intelligence_mod", function() {
        update_ac_ability("intelligence");
        update_flex_ability("intelligence","");
        update_attacks("intelligence","");
    });
    on("change:wisdom_mod", function() {
        update_ac_ability("wisdom");
        update_flex_ability("wisdom","");
        update_attacks("wisdom","");
   });
    on("change:charisma_mod", function() {
        update_ac_ability("charisma");
        update_flex_ability("charisma","");
        update_attacks("charisma","");
    });

    // === Initiative
    on("change:initiative_misc change:initiative_bonus", function() {
        update_initiative();
    });

    // === AC
    on("change:ac_ability_primary change:ac_ability_secondary change:ac_ability_maximum", function(){
        update_ac_ability();
    });
    on("change:ac_bonus change:ac_armor change:ac_shield change:ac_ability_mod change:ac_size change:ac_natural change:ac_deflection change:ac_misc change:ac_dodge change:ac_touch_bonus change:ac_flatfooted_bonus change:ac_noflatflooted change:ac_touchshield", function(){
        update_ac();
        update_cmd();
    });
    // AC Items
    on("remove:repeating_acitems change:repeating_acitems:equipped change:repeating_acitems:ac_bonus change:repeating_acitems:flatfooted_bonus change:repeating_acitems:touch_bonus change:repeating_acitems:type change:repeating_acitems:check_penalty change:repeating_acitems:max_dex_bonus change:repeating_acitems:spell_failure", function(){
        update_ac_items();
    });

    // === SAVES
    on("change:fortitude_ability change:reflex_ability change:will_ability", function(e){
        update_flex_ability(e.newValue,e.sourceAttribute);
    });
    on("change:fortitude_base change:fortitude_ability_mod change:fortitude_misc change:fortitude_bonus", function(){
        update_save("fortitude");
    });
    on("change:reflex_base change:reflex_ability_mod change:reflex_misc change:reflex_bonus", function(){
        update_save("reflex");
    });
    on("change:will_base change:will_ability_mod change:will_misc change:will_bonus", function(){
        update_save("will");
    });

    // === BAB / ATTACK MODS / DEFENSE
    on("change:bab", function(){
        update_babs("cmb");
        update_babs("melee");
        update_babs("ranged");
        update_cmd();
    });
    on("change:cmb_ability change:melee_ability change:ranged_ability", function(e){
        update_flex_ability(e.newValue,e.sourceAttribute);
    });
    on("change:cmb_ability_mod change:cmb_misc change:cmb_bonus", function(){
        update_babs("cmb");
    });
    on("change:melee_ability_mod change:melee_misc change:melee_bonus", function(){
        update_babs("melee");
    });
    on("change:ranged_ability_mod change:ranged_misc change:ranged_bonus", function(){
        update_babs("ranged");
    });
    on("change:cmd_misc change:cmd_bonus", function() {
        update_cmd();
    });
    on("change:cmb_mod", function(){update_attacks("cmb","");});
    on("change:melee_mod", function(){update_attacks("melee","");});
    on("change:ranged_mod", function(){update_attacks("ranged","");});

    // === WEAPONS / ATTACKS
    on("change:repeating_attacks:atkname change:repeating_attacks:atkflag change:repeating_attacks:atktype change:repeating_attacks:atkmod change:repeating_attacks:atkcritrange change:repeating_attacks:atkcritmulti change:repeating_attacks:dmgflag change:repeating_attacks:dmgbase change:repeating_attacks:dmgattr change:repeating_attacks:dmgmod change:repeating_attacks:dmgtype change:repeating_attacks:dmg2flag change:repeating_attacks:dmg2base change:repeating_attacks:dmg2attr change:repeating_attacks:dmg2mod change:repeating_attacks:dmg2type change:repeating_attacks:descflag change:repeating_attacks:atkdesc change:repeating_attacks:notes", function(eventinfo) {
        if(eventinfo.sourceType === "sheetworker") {return;}
        var attackid = eventinfo.sourceAttribute.substring(18, 38);
        update_attacks(attackid);
    });

    /* === FUNCTIONS === */
    // === ABILITIES and MODS
    var update_attr = function(attr) {
        var update = {};
        var attr_fields = [attr + "_base",attr + "_bonus"];
        getAttrs(attr_fields, function(v) {
            var base = parseInt(v[attr + "_base"]) || 10;
            var bonus = parseInt(v[attr + "_bonus"]) || 0;
            update[attr + "_flag"] = bonus != 0 ? 1 : 0;
            update[attr] = base + bonus;
            setAttrs(update);
        });
    };
    var update_mod = function(attr) {
        getAttrs([attr], function(v) {
            var mod = Math.floor(((parseInt(v[attr]) || 10) - 10) / 2);
            var update = {};
            update[attr + "_mod"] = mod;
            setAttrs(update);
        });
    };
    var update_flex_ability = function(attr,ablt) {
        var update = {},
            modz = [];
            modz.push(attr + "_mod");
        if (String(attr) && String(ablt)) {
            getAttrs(modz, function(v) {
                update[ablt + "_mod"] = v[attr + "_mod"];
                setAttrs(update);
            });
        } else {
            var fields = ["fortitude_ability","reflex_ability","will_ability","cmb_ability","melee_ability","ranged_ability"],
                flexes = [];
            getAttrs(fields, function(ablts) {
                _.each(fields, function(field){
                    if(ablts[field] == attr) {
                        flexes.push(field + "_mod");
                    }
                });
                if ( (parseInt(flexes.length) || 0) > 0) {
                    getAttrs(modz, function(v) {
                        _.each(flexes, function(flex) {
                            update[flex] = v[attr + "_mod"];
                        });
                        setAttrs(update);
                    });
                }
            });
        }
    };

    // === Size
    var update_size = function(psize) {
        var size = psize || "medium",
            atkac = 0,
            cmb = 0,
            fly = 0,
            stealth = 0;
        switch(size) {
            case "fine":
                atkac = 8,
                cmb = -8,
                fly = 8,
                stealth = 16;
                break;
            case "diminutive":
                atkac = 4,
                cmb = -4,
                fly = 6,
                stealth = 12;
                break;
            case "tiny":
                atkac = 2,
                cmb = -2,
                fly = 4,
                stealth = 8;
                break;
            case "small":
                atkac = 1,
                cmb = -1,
                fly = 2,
                stealth = 4;
                break;
            case "medium":
                atkac = 0,
                cmb = 0,
                fly = 0,
                stealth = 0;
                break;
            case "large":
                atkac = -1,
                cmb = 1,
                fly = -2,
                stealth = -4;
                break;
            case "huge":
                atkac = -2,
                cmb = 2,
                fly = -4,
                stealth = -8;
                break;
            case "gargantuan":
                atkac = -4,
                cmb = 4,
                fly = -6,
                stealth = -12;
                break;
            case "colossal":
                atkac = -8,
                cmb = 8,
                fly = -8,
                stealth = -16;
                break;
        }
        setAttrs({
            "ac_size": atkac,
            "bab_size": atkac,
            "cmb_size": cmb,
            "fly_size": fly,
            "stealth_size": stealth
        });
    };
    // === INITIATIVE
    var update_initiative = function () {
        getAttrs(["dexterity_mod","initiative_misc","initiative_bonus"], function(v) {
            setAttrs({"initiative_mod": (parseInt(v["dexterity_mod"]) || 0) + (parseInt(v["initiative_misc"]) || 0) + (parseInt(v["initiative_bonus"]) || 0)});
        });
    };
    // === AC
    var update_ac_items = function() {
        var update = {};
        var attrs = [];
        getSectionIDs("repeating_acitems", function(idarray) {
            _.each(idarray, function(itemid) {
                attrs.push("repeating_acitems_" + itemid + "_equipped");
                attrs.push("repeating_acitems_" + itemid + "_ac_bonus");
                attrs.push("repeating_acitems_" + itemid + "_flatfooted_bonus");
                attrs.push("repeating_acitems_" + itemid + "_touch_bonus");
                attrs.push("repeating_acitems_" + itemid + "_type");
                attrs.push("repeating_acitems_" + itemid + "_check_penalty");
                attrs.push("repeating_acitems_" + itemid + "_max_dex_bonus");
                attrs.push("repeating_acitems_" + itemid + "_spell_failure");

            });
            getAttrs(attrs, function(v) {
                var bonusarmor = 0,
                    bonusshield = 0,
                    bonusff = 0,
                    bonustouch = 0,
                    checkpen = 0,
                    maxdex = 99,
                    spellf = 0,
                    maxab = "-";
                _.each(idarray, function(itemid) {
                    if ( (parseInt(v["repeating_acitems_" + itemid + "_equipped"]) || 0) == 1 ) {
                        if ( v["repeating_acitems_" + itemid + "_type"] == "shield") {
                            bonusshield += parseInt(v["repeating_acitems_" + itemid + "_ac_bonus"]) || 0;
                        } else {
                            bonusarmor += parseInt(v["repeating_acitems_" + itemid + "_ac_bonus"]) || 0;
                        }
                        bonusff += parseInt(v["repeating_acitems_" + itemid + "_flatfooted_bonus"]) || 0;
                        bonustouch += parseInt(v["repeating_acitems_" + itemid + "_touch_bonus"]) || 0;
                        checkpen += parseInt(v["repeating_acitems_" + itemid + "_check_penalty"]) || 0;
                        if ((parseInt(v["repeating_acitems_" + itemid + "_max_dex_bonus"]) || 99) != 0) {
                            maxdex = Math.min(maxdex, parseInt(v["repeating_acitems_" + itemid + "_max_dex_bonus"]) || 99);
                        }
                        spellf += parseInt(v["repeating_acitems_" + itemid + "_spell_failure"]) || 0;
                    }
                });
                if (maxdex < 99) {
                    maxab = maxdex;
                }
                setAttrs({
                    "ac_armor": bonusarmor,
                    "ac_shield": bonusshield,
                    "ac_flatfooted_bonus": bonusff,
                    "ac_touch_bonus": bonustouch,
                    "ac_ability_maximum": maxab,
                    "armor_check_penalty": checkpen,
                    "armor_spell_failure": spellf
                });
            });
        });
    };
    var update_ac_ability = function(attr) {
        getAttrs(["ac_ability_primary","ac_ability_secondary","ac_ability_maximum"], function(v) {
            if( (attr == "") || (attr == v.ac_ability_primary) || (attr == v.ac_ability_secondary) ) {
                var attr_fields = [v.ac_ability_primary + "_mod",v.ac_ability_secondary + "_mod"];
                getAttrs(attr_fields, function(modz) {
                    var primary = parseInt(modz[v.ac_ability_primary + "_mod"]) || 0,
                        secondary = parseInt(modz[v.ac_ability_secondary + "_mod"]) || 0,
                        maxmod = parseInt(v.ac_ability_maximum) || 99;
                    setAttrs({"ac_ability_mod": Math.min(primary + secondary,maxmod)});
                });
            }
        });
    };
    var update_ac = function() {
        var update = {};
        getAttrs(["ac_bonus","ac_ability_mod","ac_armor","ac_shield","ac_size","ac_natural","ac_deflection","ac_misc","ac_dodge","ac_touch_bonus","ac_flatfooted_bonus","ac_noflatflooted","ac_touchshield"], function(v) {
            var base = 10,
                ac = 0,
                actouch = 0,
                acff = 0,
                bonus = parseInt(v.ac_bonus) || 0,
                ability = parseInt(v.ac_ability_mod) || 0,
                armor = parseInt(v.ac_armor) || 0,
                shield = parseInt(v.ac_shield) || 0,
                size = parseInt(v.ac_size) || 0,
                natural = parseInt(v.ac_natural) || 0,
                deflection = parseInt(v.ac_deflection) || 0,
                misc = parseInt(v.ac_misc) || 0,
                dodge = parseInt(v.ac_dodge) || 0,
                touch_bonus = parseInt(v.ac_touch_bonus) || 0,
                flatfooted_bonus = parseInt(v.ac_flatfooted_bonus) || 0,
                noflatflooted = parseInt(v.ac_noflatflooted) || 0,
                touchshield = parseInt(v.ac_touchshield) || 0;
            ac = base + bonus + ability + armor + shield + size + natural + deflection + misc + dodge;
            if (noflatflooted == 1) {acff = ac;}
            else {acff = base + bonus + armor + shield + size + natural + deflection + misc;}
            acff += flatfooted_bonus;
            actouch = base + bonus + ability + size + deflection + misc + dodge;
            if (touchshield == 1) {actouch += shield;}
            actouch += touch_bonus;
            setAttrs({
                "ac": ac,
                "ac_touch": actouch,
                "ac_flatfooted": acff
            });
        });
    };
    var update_cmd = function() {
        var fields = ["bab","strength_mod","dexterity_mod","cmb_size","ac_dodge","ac_deflection","cmd_misc","cmd_bonus"];
        getAttrs(fields, function(v) {
            var update = {};
            update["cmd_mod"] = 10
                            + (parseInt(v.bab) || 0)
                            + (parseInt(v.strength_mod) || 0)
                            + (parseInt(v.dexterity_mod) || 0)
                            + (parseInt(v.cmb_size) || 0)
                            + (parseInt(v.ac_dodge) || 0)
                            + (parseInt(v.ac_deflection) || 0)
                            + (parseInt(v.cmd_misc) || 0)
                            + (parseInt(v.cmd_bonus) || 0);
            setAttrs(update);
        });
        return;
    };
    // === SAVES
    var update_save = function(attr) {
        var fields = [attr + "_base",attr + "_ability_mod",attr + "_misc",attr + "_bonus"];
        getAttrs(fields, function(v) {
            var update = {};
            update[attr] = (parseInt(v[attr + "_base"]) || 0) + (parseInt(v[attr + "_ability_mod"]) || 0) + (parseInt(v[attr + "_misc"]) || 0) + (parseInt(v[attr + "_bonus"]) || 0);
            setAttrs(update);
        });
    };

    // === BABS
    var update_babs = function(attr) {
        var fields = ["bab","bab_size",attr + "_ability_mod",attr + "_misc",attr + "_bonus"];
        getAttrs(fields, function(v) {
            var update = {};
            update[attr + "_mod"] = (parseInt(v.bab) || 0) + (parseInt(v.bab_size) || 0) + (parseInt(v[attr + "_ability_mod"]) || 0) + (parseInt(v[attr + "_misc"]) || 0) + (parseInt(v[attr + "_bonus"]) || 0);
            setAttrs(update);
        });
    };

    // === WEAPONS/ATTACKS
    var update_attacks = function(update_id, source) {
        console.log("DOING UPDATE_ATTACKS: " + update_id);
        if(update_id.substring(0,1) === "-" && update_id.length === 20) {
            do_update_attack([update_id], source);
        }
        else if(["strength","dexterity","constitution","intelligence","wisdom","charisma","melee","ranged","cmb","all"].includes(update_id)) {
            getSectionIDs("repeating_attacks", function(idarray) {
                if(update_id === "all") {
                    do_update_attack(idarray);
                } else {
                    var attack_attribs = [];
                    _.each(idarray, function(id) {
                        attack_attribs.push("repeating_attacks_" + id + "_atktype");
                        attack_attribs.push("repeating_attacks_" + id + "_dmgattr");
                        attack_attribs.push("repeating_attacks_" + id + "_dmg2attr");
                    });
                    getAttrs(attack_attribs, function(v) {
                        var attr_attack_ids = [];
                        _.each(idarray, function(id) {
                            if((v["repeating_attacks_" + id + "_atktype"] && v["repeating_attacks_" + id + "_atktype"].includes(update_id)) || (v["repeating_attacks_" + id + "_dmgattr"] && v["repeating_attacks_" + id + "_dmgattr"].includes(update_id)) || (v["repeating_attacks_" + id + "_dmg2attr"] && v["repeating_attacks_" + id + "_dmg2attr"].includes(update_id))) {
                                attr_attack_ids.push(id);
                            }
                        });
                        if(attr_attack_ids.length > 0) {
                            do_update_attack(attr_attack_ids);
                        }
                    });
                };
            });
        };
    };
    var do_update_attack = function(attack_array, source) {
        var attack_attribs = ["strength_mod","dexterity_mod","constitution_mod","intelligence_mod","wisdom_mod","charisma_mod","melee_mod","ranged_mod","cmb_mod"];
        _.each(attack_array, function(attackid) {
            attack_attribs.push("repeating_attacks_" + attackid + "_atkname");
            attack_attribs.push("repeating_attacks_" + attackid + "_atkflag");
            attack_attribs.push("repeating_attacks_" + attackid + "_atktype");
            attack_attribs.push("repeating_attacks_" + attackid + "_atkmod");
            attack_attribs.push("repeating_attacks_" + attackid + "_atkvs");
            attack_attribs.push("repeating_attacks_" + attackid + "_atkcritrange");
            attack_attribs.push("repeating_attacks_" + attackid + "_atkcritmulti");
            attack_attribs.push("repeating_attacks_" + attackid + "_dmgflag");
            attack_attribs.push("repeating_attacks_" + attackid + "_dmgbase");
            attack_attribs.push("repeating_attacks_" + attackid + "_dmgattr");
            attack_attribs.push("repeating_attacks_" + attackid + "_dmgmod");
            attack_attribs.push("repeating_attacks_" + attackid + "_dmgtype");
            attack_attribs.push("repeating_attacks_" + attackid + "_dmg2flag");
            attack_attribs.push("repeating_attacks_" + attackid + "_dmg2base");
            attack_attribs.push("repeating_attacks_" + attackid + "_dmg2attr");
            attack_attribs.push("repeating_attacks_" + attackid + "_dmg2mod");
            attack_attribs.push("repeating_attacks_" + attackid + "_dmg2type");
            attack_attribs.push("repeating_attacks_" + attackid + "_descflag");
            attack_attribs.push("repeating_attacks_" + attackid + "_atkdesc");
            attack_attribs.push("repeating_attacks_" + attackid + "_notes");
        });
        getAttrs(attack_attribs, function(v) {
            _.each(attack_array, function(attackid) {
                console.log("UPDATING ATTACK: " + attackid);
                var update = {},
                    atkbonus = 0,
                    atkbonusdisplay = "-",
                    atkdmg = "",
                    atkdmgbonus = 0,
                    atkdmgdisplay = "-",
                    atkdisplay = "",
                    rollbase = "",
                    rollatk = "",
                    rolldmg = "",
                    atkname = v["repeating_attacks_" + attackid + "_atkname"],
                    atkflag = v["repeating_attacks_" + attackid + "_atkflag"],
                    atktype = parseInt(v[v["repeating_attacks_" + attackid + "_atktype"] + "_mod"]) || 0,
                    atkmod = v["repeating_attacks_" + attackid + "_atkmod"],
                    atkvs = v["repeating_attacks_" + attackid + "_atkvs"],
                    atkcritrange = parseInt(v["repeating_attacks_" + attackid + "_atkcritrange"]) || 20,
                    atkcritmulti = parseInt(v["repeating_attacks_" + attackid + "_atkcritmulti"]) || 2,
                    dmgflag = v["repeating_attacks_" + attackid + "_dmgflag"],
                    dmgbase = v["repeating_attacks_" + attackid + "_dmgbase"],
                    dmgattr = parseInt(v[v["repeating_attacks_" + attackid + "_dmgattr"] + "_mod"]) || 0,
                    dmgmod = v["repeating_attacks_" + attackid + "_dmgmod"],
                    dmgtype = v["repeating_attacks_" + attackid + "_dmgtype"],
                    dmg2flag = v["repeating_attacks_" + attackid + "_dmg2flag"],
                    dmg2base = v["repeating_attacks_" + attackid + "_dmg2base"],
                    dmg2attr = parseInt(v[v["repeating_attacks_" + attackid + "_dmg2attr"] + "_mod"]) || 0,
                    dmg2mod = v["repeating_attacks_" + attackid + "_dmg2mod"],
                    dmg2type = v["repeating_attacks_" + attackid + "_dmg2type"],
                    descflag = v["repeating_attacks_" + attackid + "_descflag"],
                    atkdesc = v["repeating_attacks_" + attackid + "_atkdesc"],
                    notes = v["repeating_attacks_" + attackid + "_notes"];
                // A LOT TO DO ! (rolls)
                // Display handling
                atkdisplay = atkname;
                atkbonus = atktype + (parseInt(atkmod) || 0);
                atkdmgbonus = dmgattr + (parseInt(dmgmod) || 0);
                // console.log("*** DEBUG atkflag / dmgflag " + atkflag + " / " + dmgflag);
                if (atkflag != "0") {
                    atkdisplay += " / " + v["repeating_attacks_" + attackid + "_atktype"] + " vs " + atkvs;
                    atkbonusdisplay = "" + (atkbonus < 0 ? "" : "+") + atkbonus;
                }
                if (dmgflag != "0") {atkdmgdisplay = "" + dmgbase + (atkdmgbonus < 0 ? " " : "+") + atkdmgbonus;}
                update["repeating_attacks_" + attackid + "_atkdisplay"] = atkdisplay;
                update["repeating_attacks_" + attackid + "_atkbonusdisplay"] = atkbonusdisplay;
                update["repeating_attacks_" + attackid + "_atkdmgdisplay"] = atkdmgdisplay;
                // update
                setAttrs(update, {silent: true});
            });
        });
    };

    // === Version and updating
    var initializeChar = function(doneupdating) {
        getAttrs(["character_name"], function(v) {
            console.log("Initializing character " + v.character_name);
            var update = {};
            update["strength_mod"] = 0;
            update["dexterity_mod"] = 0;
            update["constitution_mod"] = 0;
            update["intelligence_mod"] = 0;
            update["wisdom_mod"] = 0;
            update["charisma_mod"] = 0;
            update["initiative_mod"] = 0;
            update["initiative_mod"] = 0;
            update["ac_size"] = 0;
            update["bab_size"] = 0;
            update["cmb_size"] = 0;
            update["fly_size"] = 0;
            update["stealth_size"] = 0;
            update["ac_armor"] = 0;
            update["ac_shield"] = 0;
            update["ac_flatfooted_bonus"] = 0;
            update["ac_touch_bonus"] = 0;
            update["ac_ability_maximum"] = 0;
            update["armor_check_penalty"] = 0;
            update["armor_spell_failure"] = 0;
            update["ac"] = 10;
            update["ac_touch"] = 0;
            update["ac_flatfooted"] = 0;
            update["fortitude_ability_mod"] = 0;
            update["reflex_ability_mod"] = 0;
            update["will_ability_mod"] = 0;
            update["cmb_ability_mod"] = 0;
            update["melee_ability_mod"] = 0;
            update["ranged_ability_mod"] = 0;
            update["fortitude"] = 0;
            update["reflex"] = 0;
            update["will"] = 0;
            update["cmb"] = 0;
            update["melee"] = 0;
            update["ranged"] = 0;
            update["cmd"] = 10;
            setAttrs(update
                    ,{silent: false}
                    ,function() {
                        doneupdating();
                    });
        });
    };
    var versioning = function() {
        getAttrs(["version"], function(v) {
            var vrs = parseFloat(v["version"]) || 0.0;
            if (vrs == 1.0) {
                console.log("Pathfinder by Roll20 v" + vrs);
                return;
            } else if (vrs < 1.0) {
                initializeChar(function () {
                    setAttrs({"version": "1.0"});
                    versioning();
                });
            }
        });
    };

</script>